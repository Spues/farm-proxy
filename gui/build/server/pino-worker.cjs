"use strict";var __getOwnPropNames=Object.getOwnPropertyNames;var __commonJS=(cb,mod)=>function(){return mod||(0,cb[__getOwnPropNames(cb)[0]])((mod={exports:{}}).exports,mod),mod.exports};var require_err_helpers=__commonJS({"../../../../node_modules/pino-std-serializers/lib/err-helpers.js"(exports2,module2){"use strict";var isErrorLike=err=>err&&typeof err.message=="string",getErrorCause=err=>{if(!err)return;let cause=err.cause;if(typeof cause=="function"){let causeResult=err.cause();return isErrorLike(causeResult)?causeResult:void 0}else return isErrorLike(cause)?cause:void 0},_stackWithCauses=(err,seen)=>{if(!isErrorLike(err))return"";let stack=err.stack||"";if(seen.has(err))return stack+`
causes have become circular...`;let cause=getErrorCause(err);return cause?(seen.add(err),stack+`
caused by: `+_stackWithCauses(cause,seen)):stack},stackWithCauses=err=>_stackWithCauses(err,new Set),_messageWithCauses=(err,seen,skip)=>{if(!isErrorLike(err))return"";let message=skip?"":err.message||"";if(seen.has(err))return message+": ...";let cause=getErrorCause(err);if(cause){seen.add(err);let skipIfVErrorStyleCause=typeof err.cause=="function";return message+(skipIfVErrorStyleCause?"":": ")+_messageWithCauses(cause,seen,skipIfVErrorStyleCause)}else return message},messageWithCauses=err=>_messageWithCauses(err,new Set);module2.exports={isErrorLike,getErrorCause,stackWithCauses,messageWithCauses}}});var require_err_proto=__commonJS({"../../../../node_modules/pino-std-serializers/lib/err-proto.js"(exports2,module2){"use strict";var seen=Symbol("circular-ref-tag"),rawSymbol=Symbol("pino-raw-err-ref"),pinoErrProto=Object.create({},{type:{enumerable:!0,writable:!0,value:void 0},message:{enumerable:!0,writable:!0,value:void 0},stack:{enumerable:!0,writable:!0,value:void 0},aggregateErrors:{enumerable:!0,writable:!0,value:void 0},raw:{enumerable:!1,get:function(){return this[rawSymbol]},set:function(val){this[rawSymbol]=val}}});Object.defineProperty(pinoErrProto,rawSymbol,{writable:!0,value:{}});module2.exports={pinoErrProto,pinoErrorSymbols:{seen,rawSymbol}}}});var require_err=__commonJS({"../../../../node_modules/pino-std-serializers/lib/err.js"(exports2,module2){"use strict";module2.exports=errSerializer;var{messageWithCauses,stackWithCauses,isErrorLike}=require_err_helpers(),{pinoErrProto,pinoErrorSymbols}=require_err_proto(),{seen}=pinoErrorSymbols,{toString}=Object.prototype;function errSerializer(err){if(!isErrorLike(err))return err;err[seen]=void 0;let _err=Object.create(pinoErrProto);_err.type=toString.call(err.constructor)==="[object Function]"?err.constructor.name:err.name,_err.message=messageWithCauses(err),_err.stack=stackWithCauses(err),Array.isArray(err.errors)&&(_err.aggregateErrors=err.errors.map(err2=>errSerializer(err2)));for(let key in err)if(_err[key]===void 0){let val=err[key];isErrorLike(val)?key!=="cause"&&!Object.prototype.hasOwnProperty.call(val,seen)&&(_err[key]=errSerializer(val)):_err[key]=val}return delete err[seen],_err.raw=err,_err}}});var require_err_with_cause=__commonJS({"../../../../node_modules/pino-std-serializers/lib/err-with-cause.js"(exports2,module2){"use strict";module2.exports=errWithCauseSerializer;var{isErrorLike}=require_err_helpers(),{pinoErrProto,pinoErrorSymbols}=require_err_proto(),{seen}=pinoErrorSymbols,{toString}=Object.prototype;function errWithCauseSerializer(err){if(!isErrorLike(err))return err;err[seen]=void 0;let _err=Object.create(pinoErrProto);_err.type=toString.call(err.constructor)==="[object Function]"?err.constructor.name:err.name,_err.message=err.message,_err.stack=err.stack,Array.isArray(err.errors)&&(_err.aggregateErrors=err.errors.map(err2=>errWithCauseSerializer(err2))),isErrorLike(err.cause)&&!Object.prototype.hasOwnProperty.call(err.cause,seen)&&(_err.cause=errWithCauseSerializer(err.cause));for(let key in err)if(_err[key]===void 0){let val=err[key];isErrorLike(val)?Object.prototype.hasOwnProperty.call(val,seen)||(_err[key]=errWithCauseSerializer(val)):_err[key]=val}return delete err[seen],_err.raw=err,_err}}});var require_req=__commonJS({"../../../../node_modules/pino-std-serializers/lib/req.js"(exports2,module2){"use strict";module2.exports={mapHttpRequest,reqSerializer};var rawSymbol=Symbol("pino-raw-req-ref"),pinoReqProto=Object.create({},{id:{enumerable:!0,writable:!0,value:""},method:{enumerable:!0,writable:!0,value:""},url:{enumerable:!0,writable:!0,value:""},query:{enumerable:!0,writable:!0,value:""},params:{enumerable:!0,writable:!0,value:""},headers:{enumerable:!0,writable:!0,value:{}},remoteAddress:{enumerable:!0,writable:!0,value:""},remotePort:{enumerable:!0,writable:!0,value:""},raw:{enumerable:!1,get:function(){return this[rawSymbol]},set:function(val){this[rawSymbol]=val}}});Object.defineProperty(pinoReqProto,rawSymbol,{writable:!0,value:{}});function reqSerializer(req){let connection=req.info||req.socket,_req=Object.create(pinoReqProto);if(_req.id=typeof req.id=="function"?req.id():req.id||(req.info?req.info.id:void 0),_req.method=req.method,req.originalUrl)_req.url=req.originalUrl;else{let path=req.path;_req.url=typeof path=="string"?path:req.url?req.url.path||req.url:void 0}return req.query&&(_req.query=req.query),req.params&&(_req.params=req.params),_req.headers=req.headers,_req.remoteAddress=connection&&connection.remoteAddress,_req.remotePort=connection&&connection.remotePort,_req.raw=req.raw||req,_req}function mapHttpRequest(req){return{req:reqSerializer(req)}}}});var require_res=__commonJS({"../../../../node_modules/pino-std-serializers/lib/res.js"(exports2,module2){"use strict";module2.exports={mapHttpResponse,resSerializer};var rawSymbol=Symbol("pino-raw-res-ref"),pinoResProto=Object.create({},{statusCode:{enumerable:!0,writable:!0,value:0},headers:{enumerable:!0,writable:!0,value:""},raw:{enumerable:!1,get:function(){return this[rawSymbol]},set:function(val){this[rawSymbol]=val}}});Object.defineProperty(pinoResProto,rawSymbol,{writable:!0,value:{}});function resSerializer(res){let _res=Object.create(pinoResProto);return _res.statusCode=res.headersSent?res.statusCode:null,_res.headers=res.getHeaders?res.getHeaders():res._headers,_res.raw=res,_res}function mapHttpResponse(res){return{res:resSerializer(res)}}}});var require_pino_std_serializers=__commonJS({"../../../../node_modules/pino-std-serializers/index.js"(exports2,module2){"use strict";var errSerializer=require_err(),errWithCauseSerializer=require_err_with_cause(),reqSerializers=require_req(),resSerializers=require_res();module2.exports={err:errSerializer,errWithCause:errWithCauseSerializer,mapHttpRequest:reqSerializers.mapHttpRequest,mapHttpResponse:resSerializers.mapHttpResponse,req:reqSerializers.reqSerializer,res:resSerializers.resSerializer,wrapErrorSerializer:function(customSerializer){return customSerializer===errSerializer?customSerializer:function(err){return customSerializer(errSerializer(err))}},wrapRequestSerializer:function(customSerializer){return customSerializer===reqSerializers.reqSerializer?customSerializer:function(req){return customSerializer(reqSerializers.reqSerializer(req))}},wrapResponseSerializer:function(customSerializer){return customSerializer===resSerializers.resSerializer?customSerializer:function(res){return customSerializer(resSerializers.resSerializer(res))}}}}});var require_caller=__commonJS({"../../../../node_modules/pino/lib/caller.js"(exports2,module2){"use strict";function noOpPrepareStackTrace(_,stack){return stack}module2.exports=function(){let originalPrepare=Error.prepareStackTrace;Error.prepareStackTrace=noOpPrepareStackTrace;let stack=new Error().stack;if(Error.prepareStackTrace=originalPrepare,!Array.isArray(stack))return;let entries=stack.slice(2),fileNames=[];for(let entry of entries)entry&&fileNames.push(entry.getFileName());return fileNames}}});var require_redact=__commonJS({"../../../../node_modules/@pinojs/redact/index.js"(exports2,module2){"use strict";function deepClone(obj){if(obj===null||typeof obj!="object")return obj;if(obj instanceof Date)return new Date(obj.getTime());if(obj instanceof Array){let cloned=[];for(let i=0;i<obj.length;i++)cloned[i]=deepClone(obj[i]);return cloned}if(typeof obj=="object"){let cloned=Object.create(Object.getPrototypeOf(obj));for(let key in obj)Object.prototype.hasOwnProperty.call(obj,key)&&(cloned[key]=deepClone(obj[key]));return cloned}return obj}function parsePath(path){let parts=[],current="",inBrackets=!1,inQuotes=!1,quoteChar="";for(let i=0;i<path.length;i++){let char=path[i];!inBrackets&&char==="."?current&&(parts.push(current),current=""):char==="["?(current&&(parts.push(current),current=""),inBrackets=!0):char==="]"&&inBrackets?(parts.push(current),current="",inBrackets=!1,inQuotes=!1):(char==='"'||char==="'")&&inBrackets?inQuotes?char===quoteChar?(inQuotes=!1,quoteChar=""):current+=char:(inQuotes=!0,quoteChar=char):current+=char}return current&&parts.push(current),parts}function setValue(obj,parts,value){let current=obj;for(let i=0;i<parts.length-1;i++){let key=parts[i];if(typeof current!="object"||current===null||!(key in current)||typeof current[key]!="object"||current[key]===null)return!1;current=current[key]}let lastKey=parts[parts.length-1];if(lastKey==="*"){if(Array.isArray(current))for(let i=0;i<current.length;i++)current[i]=value;else if(typeof current=="object"&&current!==null)for(let key in current)Object.prototype.hasOwnProperty.call(current,key)&&(current[key]=value)}else typeof current=="object"&&current!==null&&lastKey in current&&Object.prototype.hasOwnProperty.call(current,lastKey)&&(current[lastKey]=value);return!0}function removeKey(obj,parts){let current=obj;for(let i=0;i<parts.length-1;i++){let key=parts[i];if(typeof current!="object"||current===null||!(key in current)||typeof current[key]!="object"||current[key]===null)return!1;current=current[key]}let lastKey=parts[parts.length-1];if(lastKey==="*"){if(Array.isArray(current))for(let i=0;i<current.length;i++)current[i]=void 0;else if(typeof current=="object"&&current!==null)for(let key in current)Object.prototype.hasOwnProperty.call(current,key)&&delete current[key]}else typeof current=="object"&&current!==null&&lastKey in current&&Object.prototype.hasOwnProperty.call(current,lastKey)&&delete current[lastKey];return!0}var PATH_NOT_FOUND=Symbol("PATH_NOT_FOUND");function getValueIfExists(obj,parts){let current=obj;for(let part of parts){if(current==null||typeof current!="object"||current===null||!(part in current))return PATH_NOT_FOUND;current=current[part]}return current}function getValue(obj,parts){let current=obj;for(let part of parts){if(current==null||typeof current!="object"||current===null)return;current=current[part]}return current}function redactPaths(obj,paths,censor,remove=!1){for(let path of paths){let parts=parsePath(path);if(parts.includes("*"))redactWildcardPath(obj,parts,censor,path,remove);else if(remove)removeKey(obj,parts);else{let value=getValueIfExists(obj,parts);if(value===PATH_NOT_FOUND)continue;let actualCensor=typeof censor=="function"?censor(value,parts):censor;setValue(obj,parts,actualCensor)}}}function redactWildcardPath(obj,parts,censor,originalPath,remove=!1){let wildcardIndex=parts.indexOf("*");if(wildcardIndex===parts.length-1){let parentParts=parts.slice(0,-1),current=obj;for(let part of parentParts){if(current==null||typeof current!="object"||current===null)return;current=current[part]}if(Array.isArray(current))if(remove)for(let i=0;i<current.length;i++)current[i]=void 0;else for(let i=0;i<current.length;i++){let indexPath=[...parentParts,i.toString()],actualCensor=typeof censor=="function"?censor(current[i],indexPath):censor;current[i]=actualCensor}else if(typeof current=="object"&&current!==null)if(remove){let keysToDelete=[];for(let key in current)Object.prototype.hasOwnProperty.call(current,key)&&keysToDelete.push(key);for(let key of keysToDelete)delete current[key]}else for(let key in current){let keyPath=[...parentParts,key],actualCensor=typeof censor=="function"?censor(current[key],keyPath):censor;current[key]=actualCensor}}else redactIntermediateWildcard(obj,parts,censor,wildcardIndex,originalPath,remove)}function redactIntermediateWildcard(obj,parts,censor,wildcardIndex,originalPath,remove=!1){let beforeWildcard=parts.slice(0,wildcardIndex),afterWildcard=parts.slice(wildcardIndex+1),pathArray=[];function traverse(current,pathLength){if(pathLength===beforeWildcard.length){if(Array.isArray(current))for(let i=0;i<current.length;i++)pathArray[pathLength]=i.toString(),traverse(current[i],pathLength+1);else if(typeof current=="object"&&current!==null)for(let key in current)pathArray[pathLength]=key,traverse(current[key],pathLength+1)}else if(pathLength<beforeWildcard.length){let nextKey=beforeWildcard[pathLength];current&&typeof current=="object"&&current!==null&&nextKey in current&&(pathArray[pathLength]=nextKey,traverse(current[nextKey],pathLength+1))}else if(afterWildcard.includes("*"))redactWildcardPath(current,afterWildcard,typeof censor=="function"?(value,path)=>{let fullPath=[...pathArray.slice(0,pathLength),...path];return censor(value,fullPath)}:censor,originalPath,remove);else if(remove)removeKey(current,afterWildcard);else{let actualCensor=typeof censor=="function"?censor(getValue(current,afterWildcard),[...pathArray.slice(0,pathLength),...afterWildcard]):censor;setValue(current,afterWildcard,actualCensor)}}if(beforeWildcard.length===0)traverse(obj,0);else{let current=obj;for(let i=0;i<beforeWildcard.length;i++){let part=beforeWildcard[i];if(current==null||typeof current!="object"||current===null)return;current=current[part],pathArray[i]=part}current!=null&&traverse(current,beforeWildcard.length)}}function buildPathStructure(pathsToClone){if(pathsToClone.length===0)return null;let pathStructure=new Map;for(let path of pathsToClone){let parts=parsePath(path),current=pathStructure;for(let i=0;i<parts.length;i++){let part=parts[i];current.has(part)||current.set(part,new Map),current=current.get(part)}}return pathStructure}function selectiveClone(obj,pathStructure){if(!pathStructure)return obj;function cloneSelectively(source,pathMap,depth=0){if(!pathMap||pathMap.size===0||source===null||typeof source!="object")return source;if(source instanceof Date)return new Date(source.getTime());if(Array.isArray(source)){let cloned2=[];for(let i=0;i<source.length;i++){let indexStr=i.toString();pathMap.has(indexStr)||pathMap.has("*")?cloned2[i]=cloneSelectively(source[i],pathMap.get(indexStr)||pathMap.get("*")):cloned2[i]=source[i]}return cloned2}let cloned=Object.create(Object.getPrototypeOf(source));for(let key in source)Object.prototype.hasOwnProperty.call(source,key)&&(pathMap.has(key)||pathMap.has("*")?cloned[key]=cloneSelectively(source[key],pathMap.get(key)||pathMap.get("*")):cloned[key]=source[key]);return cloned}return cloneSelectively(obj,pathStructure)}function validatePath(path){if(typeof path!="string")throw new Error("Paths must be (non-empty) strings");if(path==="")throw new Error("Invalid redaction path ()");if(path.includes(".."))throw new Error(`Invalid redaction path (${path})`);if(path.includes(","))throw new Error(`Invalid redaction path (${path})`);let bracketCount=0,inQuotes=!1,quoteChar="";for(let i=0;i<path.length;i++){let char=path[i];if((char==='"'||char==="'")&&bracketCount>0)inQuotes?char===quoteChar&&(inQuotes=!1,quoteChar=""):(inQuotes=!0,quoteChar=char);else if(char==="["&&!inQuotes)bracketCount++;else if(char==="]"&&!inQuotes&&(bracketCount--,bracketCount<0))throw new Error(`Invalid redaction path (${path})`)}if(bracketCount!==0)throw new Error(`Invalid redaction path (${path})`)}function validatePaths(paths){if(!Array.isArray(paths))throw new TypeError("paths must be an array");for(let path of paths)validatePath(path)}function slowRedact(options={}){let{paths=[],censor="[REDACTED]",serialize=JSON.stringify,strict=!0,remove=!1}=options;validatePaths(paths);let pathStructure=buildPathStructure(paths);return function(obj){if(strict&&(obj===null||typeof obj!="object")&&(obj==null||typeof obj!="object"))return serialize?serialize(obj):obj;let cloned=selectiveClone(obj,pathStructure),original=obj,actualCensor=censor;return typeof censor=="function"&&(actualCensor=censor),redactPaths(cloned,paths,actualCensor,remove),serialize===!1?(cloned.restore=function(){return deepClone(original)},cloned):typeof serialize=="function"?serialize(cloned):JSON.stringify(cloned)}}module2.exports=slowRedact}});var require_symbols=__commonJS({"../../../../node_modules/pino/lib/symbols.js"(exports2,module2){"use strict";var setLevelSym=Symbol("pino.setLevel"),getLevelSym=Symbol("pino.getLevel"),levelValSym=Symbol("pino.levelVal"),levelCompSym=Symbol("pino.levelComp"),useLevelLabelsSym=Symbol("pino.useLevelLabels"),useOnlyCustomLevelsSym=Symbol("pino.useOnlyCustomLevels"),mixinSym=Symbol("pino.mixin"),lsCacheSym=Symbol("pino.lsCache"),chindingsSym=Symbol("pino.chindings"),asJsonSym=Symbol("pino.asJson"),writeSym=Symbol("pino.write"),redactFmtSym=Symbol("pino.redactFmt"),timeSym=Symbol("pino.time"),timeSliceIndexSym=Symbol("pino.timeSliceIndex"),streamSym=Symbol("pino.stream"),stringifySym=Symbol("pino.stringify"),stringifySafeSym=Symbol("pino.stringifySafe"),stringifiersSym=Symbol("pino.stringifiers"),endSym=Symbol("pino.end"),formatOptsSym=Symbol("pino.formatOpts"),messageKeySym=Symbol("pino.messageKey"),errorKeySym=Symbol("pino.errorKey"),nestedKeySym=Symbol("pino.nestedKey"),nestedKeyStrSym=Symbol("pino.nestedKeyStr"),mixinMergeStrategySym=Symbol("pino.mixinMergeStrategy"),msgPrefixSym=Symbol("pino.msgPrefix"),wildcardFirstSym=Symbol("pino.wildcardFirst"),serializersSym=Symbol.for("pino.serializers"),formattersSym=Symbol.for("pino.formatters"),hooksSym=Symbol.for("pino.hooks"),needsMetadataGsym=Symbol.for("pino.metadata");module2.exports={setLevelSym,getLevelSym,levelValSym,levelCompSym,useLevelLabelsSym,mixinSym,lsCacheSym,chindingsSym,asJsonSym,writeSym,serializersSym,redactFmtSym,timeSym,timeSliceIndexSym,streamSym,stringifySym,stringifySafeSym,stringifiersSym,endSym,formatOptsSym,messageKeySym,errorKeySym,nestedKeySym,wildcardFirstSym,needsMetadataGsym,useOnlyCustomLevelsSym,formattersSym,hooksSym,nestedKeyStrSym,mixinMergeStrategySym,msgPrefixSym}}});var require_redaction=__commonJS({"../../../../node_modules/pino/lib/redaction.js"(exports2,module2){"use strict";var Redact=require_redact(),{redactFmtSym,wildcardFirstSym}=require_symbols(),rx=/[^.[\]]+|\[([^[\]]*?)\]/g,CENSOR="[Redacted]",strict=!1;function redaction(opts,serialize){let{paths,censor,remove}=handle(opts),shape=paths.reduce((o,str)=>{rx.lastIndex=0;let first=rx.exec(str),next=rx.exec(str),ns=first[1]!==void 0?first[1].replace(/^(?:"|'|`)(.*)(?:"|'|`)$/,"$1"):first[0];if(ns==="*"&&(ns=wildcardFirstSym),next===null)return o[ns]=null,o;if(o[ns]===null)return o;let{index}=next,nextPath=`${str.substr(index,str.length-1)}`;return o[ns]=o[ns]||[],ns!==wildcardFirstSym&&o[ns].length===0&&o[ns].push(...o[wildcardFirstSym]||[]),ns===wildcardFirstSym&&Object.keys(o).forEach(function(k){o[k]&&o[k].push(nextPath)}),o[ns].push(nextPath),o},{}),result={[redactFmtSym]:Redact({paths,censor,serialize,strict,remove})},topCensor=(...args)=>serialize(typeof censor=="function"?censor(...args):censor);return[...Object.keys(shape),...Object.getOwnPropertySymbols(shape)].reduce((o,k)=>{if(shape[k]===null)o[k]=value=>topCensor(value,[k]);else{let wrappedCensor=typeof censor=="function"?(value,path)=>censor(value,[k,...path]):censor;o[k]=Redact({paths:shape[k],censor:wrappedCensor,serialize,strict,remove})}return o},result)}function handle(opts){if(Array.isArray(opts))return opts={paths:opts,censor:CENSOR},opts;let{paths,censor=CENSOR,remove}=opts;if(Array.isArray(paths)===!1)throw Error("pino \u2013 redact must contain an array of strings");return remove===!0&&(censor=void 0),{paths,censor,remove}}module2.exports=redaction}});var require_time=__commonJS({"../../../../node_modules/pino/lib/time.js"(exports2,module2){"use strict";var nullTime=()=>"",epochTime=()=>`,"time":${Date.now()}`,unixTime=()=>`,"time":${Math.round(Date.now()/1e3)}`,isoTime=()=>`,"time":"${new Date(Date.now()).toISOString()}"`,NS_PER_MS=1000000n,NS_PER_SEC=1000000000n,startWallTimeNs=BigInt(Date.now())*NS_PER_MS,startHrTime=process.hrtime.bigint(),isoTimeNano=()=>{let elapsedNs=process.hrtime.bigint()-startHrTime,currentTimeNs=startWallTimeNs+elapsedNs,secondsSinceEpoch=currentTimeNs/NS_PER_SEC,nanosWithinSecond=currentTimeNs%NS_PER_SEC,msSinceEpoch=Number(secondsSinceEpoch*1000n+nanosWithinSecond/1000000n),date=new Date(msSinceEpoch),year=date.getUTCFullYear(),month=(date.getUTCMonth()+1).toString().padStart(2,"0"),day=date.getUTCDate().toString().padStart(2,"0"),hours=date.getUTCHours().toString().padStart(2,"0"),minutes=date.getUTCMinutes().toString().padStart(2,"0"),seconds=date.getUTCSeconds().toString().padStart(2,"0");return`,"time":"${year}-${month}-${day}T${hours}:${minutes}:${seconds}.${nanosWithinSecond.toString().padStart(9,"0")}Z"`};module2.exports={nullTime,epochTime,unixTime,isoTime,isoTimeNano}}});var require_quick_format_unescaped=__commonJS({"../../../../node_modules/quick-format-unescaped/index.js"(exports2,module2){"use strict";function tryStringify(o){try{return JSON.stringify(o)}catch{return'"[Circular]"'}}module2.exports=format;function format(f,args,opts){var ss=opts&&opts.stringify||tryStringify,offset=1;if(typeof f=="object"&&f!==null){var len=args.length+offset;if(len===1)return f;var objects=new Array(len);objects[0]=ss(f);for(var index=1;index<len;index++)objects[index]=ss(args[index]);return objects.join(" ")}if(typeof f!="string")return f;var argLen=args.length;if(argLen===0)return f;for(var str="",a=1-offset,lastPos=-1,flen=f&&f.length||0,i=0;i<flen;){if(f.charCodeAt(i)===37&&i+1<flen){switch(lastPos=lastPos>-1?lastPos:0,f.charCodeAt(i+1)){case 100:case 102:if(a>=argLen||args[a]==null)break;lastPos<i&&(str+=f.slice(lastPos,i)),str+=Number(args[a]),lastPos=i+2,i++;break;case 105:if(a>=argLen||args[a]==null)break;lastPos<i&&(str+=f.slice(lastPos,i)),str+=Math.floor(Number(args[a])),lastPos=i+2,i++;break;case 79:case 111:case 106:if(a>=argLen||args[a]===void 0)break;lastPos<i&&(str+=f.slice(lastPos,i));var type=typeof args[a];if(type==="string"){str+="'"+args[a]+"'",lastPos=i+2,i++;break}if(type==="function"){str+=args[a].name||"<anonymous>",lastPos=i+2,i++;break}str+=ss(args[a]),lastPos=i+2,i++;break;case 115:if(a>=argLen)break;lastPos<i&&(str+=f.slice(lastPos,i)),str+=String(args[a]),lastPos=i+2,i++;break;case 37:lastPos<i&&(str+=f.slice(lastPos,i)),str+="%",lastPos=i+2,i++,a--;break}++a}++i}return lastPos===-1?f:(lastPos<flen&&(str+=f.slice(lastPos)),str)}}});var require_atomic_sleep=__commonJS({"../../../../node_modules/atomic-sleep/index.js"(exports2,module2){"use strict";if(typeof SharedArrayBuffer<"u"&&typeof Atomics<"u"){let sleep=function(ms){if((ms>0&&ms<1/0)===!1)throw typeof ms!="number"&&typeof ms!="bigint"?TypeError("sleep: ms must be a number"):RangeError("sleep: ms must be a number that is greater than 0 but less than Infinity");Atomics.wait(nil,0,0,Number(ms))},nil=new Int32Array(new SharedArrayBuffer(4));module2.exports=sleep}else{let sleep=function(ms){if((ms>0&&ms<1/0)===!1)throw typeof ms!="number"&&typeof ms!="bigint"?TypeError("sleep: ms must be a number"):RangeError("sleep: ms must be a number that is greater than 0 but less than Infinity");let target=Date.now()+Number(ms);for(;target>Date.now(););};module2.exports=sleep}}});var require_sonic_boom=__commonJS({"../../../../node_modules/sonic-boom/index.js"(exports2,module2){"use strict";var fs=require("fs"),EventEmitter=require("events"),inherits=require("util").inherits,path=require("path"),sleep=require_atomic_sleep(),assert=require("assert"),BUSY_WRITE_TIMEOUT=100,kEmptyBuffer=Buffer.allocUnsafe(0),MAX_WRITE=16*1024,kContentModeBuffer="buffer",kContentModeUtf8="utf8",[major,minor]=(process.versions.node||"0.0").split(".").map(Number),kCopyBuffer=major>=22&&minor>=7;function openFile(file,sonic){sonic._opening=!0,sonic._writing=!0,sonic._asyncDrainScheduled=!1;function fileOpened(err,fd){if(err){sonic._reopening=!1,sonic._writing=!1,sonic._opening=!1,sonic.sync?process.nextTick(()=>{sonic.listenerCount("error")>0&&sonic.emit("error",err)}):sonic.emit("error",err);return}let reopening=sonic._reopening;sonic.fd=fd,sonic.file=file,sonic._reopening=!1,sonic._opening=!1,sonic._writing=!1,sonic.sync?process.nextTick(()=>sonic.emit("ready")):sonic.emit("ready"),!sonic.destroyed&&(!sonic._writing&&sonic._len>sonic.minLength||sonic._flushPending?sonic._actualWrite():reopening&&process.nextTick(()=>sonic.emit("drain")))}let flags=sonic.append?"a":"w",mode=sonic.mode;if(sonic.sync)try{sonic.mkdir&&fs.mkdirSync(path.dirname(file),{recursive:!0});let fd=fs.openSync(file,flags,mode);fileOpened(null,fd)}catch(err){throw fileOpened(err),err}else sonic.mkdir?fs.mkdir(path.dirname(file),{recursive:!0},err=>{if(err)return fileOpened(err);fs.open(file,flags,mode,fileOpened)}):fs.open(file,flags,mode,fileOpened)}function SonicBoom(opts){if(!(this instanceof SonicBoom))return new SonicBoom(opts);let{fd,dest,minLength,maxLength,maxWrite,periodicFlush,sync,append=!0,mkdir,retryEAGAIN,fsync,contentMode,mode}=opts||{};fd=fd||dest,this._len=0,this.fd=-1,this._bufs=[],this._lens=[],this._writing=!1,this._ending=!1,this._reopening=!1,this._asyncDrainScheduled=!1,this._flushPending=!1,this._hwm=Math.max(minLength||0,16387),this.file=null,this.destroyed=!1,this.minLength=minLength||0,this.maxLength=maxLength||0,this.maxWrite=maxWrite||MAX_WRITE,this._periodicFlush=periodicFlush||0,this._periodicFlushTimer=void 0,this.sync=sync||!1,this.writable=!0,this._fsync=fsync||!1,this.append=append||!1,this.mode=mode,this.retryEAGAIN=retryEAGAIN||(()=>!0),this.mkdir=mkdir||!1;let fsWriteSync,fsWrite;if(contentMode===kContentModeBuffer)this._writingBuf=kEmptyBuffer,this.write=writeBuffer,this.flush=flushBuffer,this.flushSync=flushBufferSync,this._actualWrite=actualWriteBuffer,fsWriteSync=()=>fs.writeSync(this.fd,this._writingBuf),fsWrite=()=>fs.write(this.fd,this._writingBuf,this.release);else if(contentMode===void 0||contentMode===kContentModeUtf8)this._writingBuf="",this.write=write,this.flush=flush,this.flushSync=flushSync,this._actualWrite=actualWrite,fsWriteSync=()=>fs.writeSync(this.fd,this._writingBuf,"utf8"),fsWrite=()=>fs.write(this.fd,this._writingBuf,"utf8",this.release);else throw new Error(`SonicBoom supports "${kContentModeUtf8}" and "${kContentModeBuffer}", but passed ${contentMode}`);if(typeof fd=="number")this.fd=fd,process.nextTick(()=>this.emit("ready"));else if(typeof fd=="string")openFile(fd,this);else throw new Error("SonicBoom supports only file descriptors and files");if(this.minLength>=this.maxWrite)throw new Error(`minLength should be smaller than maxWrite (${this.maxWrite})`);this.release=(err,n)=>{if(err){if((err.code==="EAGAIN"||err.code==="EBUSY")&&this.retryEAGAIN(err,this._writingBuf.length,this._len-this._writingBuf.length))if(this.sync)try{sleep(BUSY_WRITE_TIMEOUT),this.release(void 0,0)}catch(err2){this.release(err2)}else setTimeout(fsWrite,BUSY_WRITE_TIMEOUT);else this._writing=!1,this.emit("error",err);return}this.emit("write",n);let releasedBufObj=releaseWritingBuf(this._writingBuf,this._len,n);if(this._len=releasedBufObj.len,this._writingBuf=releasedBufObj.writingBuf,this._writingBuf.length){if(!this.sync){fsWrite();return}try{do{let n2=fsWriteSync(),releasedBufObj2=releaseWritingBuf(this._writingBuf,this._len,n2);this._len=releasedBufObj2.len,this._writingBuf=releasedBufObj2.writingBuf}while(this._writingBuf.length)}catch(err2){this.release(err2);return}}this._fsync&&fs.fsyncSync(this.fd);let len=this._len;this._reopening?(this._writing=!1,this._reopening=!1,this.reopen()):len>this.minLength?this._actualWrite():this._ending?len>0?this._actualWrite():(this._writing=!1,actualClose(this)):(this._writing=!1,this.sync?this._asyncDrainScheduled||(this._asyncDrainScheduled=!0,process.nextTick(emitDrain,this)):this.emit("drain"))},this.on("newListener",function(name){name==="drain"&&(this._asyncDrainScheduled=!1)}),this._periodicFlush!==0&&(this._periodicFlushTimer=setInterval(()=>this.flush(null),this._periodicFlush),this._periodicFlushTimer.unref())}function releaseWritingBuf(writingBuf,len,n){return typeof writingBuf=="string"&&Buffer.byteLength(writingBuf)!==n&&(n=Buffer.from(writingBuf).subarray(0,n).toString().length),len=Math.max(len-n,0),writingBuf=writingBuf.slice(n),{writingBuf,len}}function emitDrain(sonic){sonic.listenerCount("drain")>0&&(sonic._asyncDrainScheduled=!1,sonic.emit("drain"))}inherits(SonicBoom,EventEmitter);function mergeBuf(bufs,len){return bufs.length===0?kEmptyBuffer:bufs.length===1?bufs[0]:Buffer.concat(bufs,len)}function write(data){if(this.destroyed)throw new Error("SonicBoom destroyed");let len=this._len+data.length,bufs=this._bufs;return this.maxLength&&len>this.maxLength?(this.emit("drop",data),this._len<this._hwm):(bufs.length===0||bufs[bufs.length-1].length+data.length>this.maxWrite?bufs.push(""+data):bufs[bufs.length-1]+=data,this._len=len,!this._writing&&this._len>=this.minLength&&this._actualWrite(),this._len<this._hwm)}function writeBuffer(data){if(this.destroyed)throw new Error("SonicBoom destroyed");let len=this._len+data.length,bufs=this._bufs,lens=this._lens;return this.maxLength&&len>this.maxLength?(this.emit("drop",data),this._len<this._hwm):(bufs.length===0||lens[lens.length-1]+data.length>this.maxWrite?(bufs.push([data]),lens.push(data.length)):(bufs[bufs.length-1].push(data),lens[lens.length-1]+=data.length),this._len=len,!this._writing&&this._len>=this.minLength&&this._actualWrite(),this._len<this._hwm)}function callFlushCallbackOnDrain(cb){this._flushPending=!0;let onDrain=()=>{if(this._fsync)this._flushPending=!1,cb();else try{fs.fsync(this.fd,err=>{this._flushPending=!1,cb(err)})}catch(err){cb(err)}this.off("error",onError)},onError=err=>{this._flushPending=!1,cb(err),this.off("drain",onDrain)};this.once("drain",onDrain),this.once("error",onError)}function flush(cb){if(cb!=null&&typeof cb!="function")throw new Error("flush cb must be a function");if(this.destroyed){let error=new Error("SonicBoom destroyed");if(cb){cb(error);return}throw error}if(this.minLength<=0){cb?.();return}cb&&callFlushCallbackOnDrain.call(this,cb),!this._writing&&(this._bufs.length===0&&this._bufs.push(""),this._actualWrite())}function flushBuffer(cb){if(cb!=null&&typeof cb!="function")throw new Error("flush cb must be a function");if(this.destroyed){let error=new Error("SonicBoom destroyed");if(cb){cb(error);return}throw error}if(this.minLength<=0){cb?.();return}cb&&callFlushCallbackOnDrain.call(this,cb),!this._writing&&(this._bufs.length===0&&(this._bufs.push([]),this._lens.push(0)),this._actualWrite())}SonicBoom.prototype.reopen=function(file){if(this.destroyed)throw new Error("SonicBoom destroyed");if(this._opening){this.once("ready",()=>{this.reopen(file)});return}if(this._ending)return;if(!this.file)throw new Error("Unable to reopen a file descriptor, you must pass a file to SonicBoom");if(file&&(this.file=file),this._reopening=!0,this._writing)return;let fd=this.fd;this.once("ready",()=>{fd!==this.fd&&fs.close(fd,err=>{if(err)return this.emit("error",err)})}),openFile(this.file,this)};SonicBoom.prototype.end=function(){if(this.destroyed)throw new Error("SonicBoom destroyed");if(this._opening){this.once("ready",()=>{this.end()});return}this._ending||(this._ending=!0,!this._writing&&(this._len>0&&this.fd>=0?this._actualWrite():actualClose(this)))};function flushSync(){if(this.destroyed)throw new Error("SonicBoom destroyed");if(this.fd<0)throw new Error("sonic boom is not ready yet");!this._writing&&this._writingBuf.length>0&&(this._bufs.unshift(this._writingBuf),this._writingBuf="");let buf="";for(;this._bufs.length||buf;){buf.length<=0&&(buf=this._bufs[0]);try{let n=fs.writeSync(this.fd,buf,"utf8"),releasedBufObj=releaseWritingBuf(buf,this._len,n);buf=releasedBufObj.writingBuf,this._len=releasedBufObj.len,buf.length<=0&&this._bufs.shift()}catch(err){if((err.code==="EAGAIN"||err.code==="EBUSY")&&!this.retryEAGAIN(err,buf.length,this._len-buf.length))throw err;sleep(BUSY_WRITE_TIMEOUT)}}try{fs.fsyncSync(this.fd)}catch{}}function flushBufferSync(){if(this.destroyed)throw new Error("SonicBoom destroyed");if(this.fd<0)throw new Error("sonic boom is not ready yet");!this._writing&&this._writingBuf.length>0&&(this._bufs.unshift([this._writingBuf]),this._writingBuf=kEmptyBuffer);let buf=kEmptyBuffer;for(;this._bufs.length||buf.length;){buf.length<=0&&(buf=mergeBuf(this._bufs[0],this._lens[0]));try{let n=fs.writeSync(this.fd,buf);buf=buf.subarray(n),this._len=Math.max(this._len-n,0),buf.length<=0&&(this._bufs.shift(),this._lens.shift())}catch(err){if((err.code==="EAGAIN"||err.code==="EBUSY")&&!this.retryEAGAIN(err,buf.length,this._len-buf.length))throw err;sleep(BUSY_WRITE_TIMEOUT)}}}SonicBoom.prototype.destroy=function(){this.destroyed||actualClose(this)};function actualWrite(){let release=this.release;if(this._writing=!0,this._writingBuf=this._writingBuf||this._bufs.shift()||"",this.sync)try{let written=fs.writeSync(this.fd,this._writingBuf,"utf8");release(null,written)}catch(err){release(err)}else fs.write(this.fd,this._writingBuf,"utf8",release)}function actualWriteBuffer(){let release=this.release;if(this._writing=!0,this._writingBuf=this._writingBuf.length?this._writingBuf:mergeBuf(this._bufs.shift(),this._lens.shift()),this.sync)try{let written=fs.writeSync(this.fd,this._writingBuf);release(null,written)}catch(err){release(err)}else kCopyBuffer&&(this._writingBuf=Buffer.from(this._writingBuf)),fs.write(this.fd,this._writingBuf,release)}function actualClose(sonic){if(sonic.fd===-1){sonic.once("ready",actualClose.bind(null,sonic));return}sonic._periodicFlushTimer!==void 0&&clearInterval(sonic._periodicFlushTimer),sonic.destroyed=!0,sonic._bufs=[],sonic._lens=[],assert(typeof sonic.fd=="number",`sonic.fd must be a number, got ${typeof sonic.fd}`);try{fs.fsync(sonic.fd,closeWrapped)}catch{}function closeWrapped(){sonic.fd!==1&&sonic.fd!==2?fs.close(sonic.fd,done):done()}function done(err){if(err){sonic.emit("error",err);return}sonic._ending&&!sonic._writing&&sonic.emit("finish"),sonic.emit("close")}}SonicBoom.SonicBoom=SonicBoom;SonicBoom.default=SonicBoom;module2.exports=SonicBoom}});var require_on_exit_leak_free=__commonJS({"../../../../node_modules/on-exit-leak-free/index.js"(exports2,module2){"use strict";var refs={exit:[],beforeExit:[]},functions={exit:onExit,beforeExit:onBeforeExit},registry;function ensureRegistry(){registry===void 0&&(registry=new FinalizationRegistry(clear))}function install(event){refs[event].length>0||process.on(event,functions[event])}function uninstall(event){refs[event].length>0||(process.removeListener(event,functions[event]),refs.exit.length===0&&refs.beforeExit.length===0&&(registry=void 0))}function onExit(){callRefs("exit")}function onBeforeExit(){callRefs("beforeExit")}function callRefs(event){for(let ref of refs[event]){let obj=ref.deref(),fn=ref.fn;obj!==void 0&&fn(obj,event)}refs[event]=[]}function clear(ref){for(let event of["exit","beforeExit"]){let index=refs[event].indexOf(ref);refs[event].splice(index,index+1),uninstall(event)}}function _register(event,obj,fn){if(obj===void 0)throw new Error("the object can't be undefined");install(event);let ref=new WeakRef(obj);ref.fn=fn,ensureRegistry(),registry.register(obj,ref),refs[event].push(ref)}function register(obj,fn){_register("exit",obj,fn)}function registerBeforeExit(obj,fn){_register("beforeExit",obj,fn)}function unregister(obj){if(registry!==void 0){registry.unregister(obj);for(let event of["exit","beforeExit"])refs[event]=refs[event].filter(ref=>{let _obj=ref.deref();return _obj&&_obj!==obj}),uninstall(event)}}module2.exports={register,registerBeforeExit,unregister}}});var require_package=__commonJS({"../../../../node_modules/thread-stream/package.json"(exports2,module2){module2.exports={name:"thread-stream",version:"4.0.0",description:"A streaming way to send data to a Node.js Worker Thread",main:"index.js",types:"index.d.ts",engines:{node:">=20"},dependencies:{"real-require":"^0.2.0"},devDependencies:{"@types/node":"^22.0.0","@yao-pkg/pkg":"^6.0.0",borp:"^0.21.0",desm:"^1.3.0",eslint:"^9.39.1",fastbench:"^1.0.1",husky:"^9.0.6",neostandard:"^0.12.2","pino-elasticsearch":"^8.0.0","sonic-boom":"^4.0.1","ts-node":"^10.8.0",typescript:"~5.7.3"},scripts:{build:"tsc --noEmit",lint:"eslint",test:"npm run lint && npm run build && npm run transpile && borp --pattern 'test/*.test.{js,mjs}'","test:ci":"npm run lint && npm run transpile && borp --pattern 'test/*.test.{js,mjs}'","test:yarn":"npm run transpile && borp --pattern 'test/*.test.js'",transpile:"sh ./test/ts/transpile.sh",prepare:"husky install"},repository:{type:"git",url:"git+https://github.com/mcollina/thread-stream.git"},keywords:["worker","thread","threads","stream"],author:"Matteo Collina <hello@matteocollina.com>",license:"MIT",bugs:{url:"https://github.com/mcollina/thread-stream/issues"},homepage:"https://github.com/mcollina/thread-stream#readme"}}});var require_wait=__commonJS({"../../../../node_modules/thread-stream/lib/wait.js"(exports2,module2){"use strict";function wait(state,index,expected,timeout,done){let max=timeout===1/0?1/0:Date.now()+timeout,check=()=>{let current=Atomics.load(state,index);if(current===expected){done(null,"ok");return}if(max!==1/0&&Date.now()>max){done(null,"timed-out");return}let remaining=max===1/0?1e4:Math.min(1e4,Math.max(1,max-Date.now())),result=Atomics.waitAsync(state,index,current,remaining);result.async?result.value.then(check):setImmediate(check)};check()}function waitDiff(state,index,expected,timeout,done){let max=timeout===1/0?1/0:Date.now()+timeout,check=()=>{if(Atomics.load(state,index)!==expected){done(null,"ok");return}if(max!==1/0&&Date.now()>max){done(null,"timed-out");return}let remaining=max===1/0?1e4:Math.min(1e4,Math.max(1,max-Date.now())),result=Atomics.waitAsync(state,index,expected,remaining);result.async?result.value.then(check):setImmediate(check)};check()}module2.exports={wait,waitDiff}}});var require_indexes=__commonJS({"../../../../node_modules/thread-stream/lib/indexes.js"(exports2,module2){"use strict";module2.exports={WRITE_INDEX:4,READ_INDEX:8}}});var require_thread_stream=__commonJS({"../../../../node_modules/thread-stream/index.js"(exports2,module2){"use strict";var{version}=require_package(),{EventEmitter}=require("events"),{Worker}=require("worker_threads"),{join}=require("path"),{pathToFileURL}=require("url"),{wait}=require_wait(),{WRITE_INDEX,READ_INDEX}=require_indexes(),buffer=require("buffer"),assert=require("assert"),kImpl=Symbol("kImpl"),MAX_STRING=buffer.constants.MAX_STRING_LENGTH,FakeWeakRef=class{constructor(value){this._value=value}deref(){return this._value}},FakeFinalizationRegistry=class{register(){}unregister(){}},FinalizationRegistry2=process.env.NODE_V8_COVERAGE?FakeFinalizationRegistry:global.FinalizationRegistry||FakeFinalizationRegistry,WeakRef2=process.env.NODE_V8_COVERAGE?FakeWeakRef:global.WeakRef||FakeWeakRef,registry=new FinalizationRegistry2(worker=>{worker.exited||worker.terminate()});function createWorker(stream,opts){let{filename,workerData}=opts,toExecute=("__bundlerPathsOverrides"in globalThis?globalThis.__bundlerPathsOverrides:{})["thread-stream-worker"]||join(__dirname,"lib","worker.js"),worker=new Worker(toExecute,{...opts.workerOpts,trackUnmanagedFds:!1,workerData:{filename:filename.indexOf("file://")===0?filename:pathToFileURL(filename).href,dataBuf:stream[kImpl].dataBuf,stateBuf:stream[kImpl].stateBuf,workerData:{$context:{threadStreamVersion:version},...workerData}}});return worker.stream=new FakeWeakRef(stream),worker.on("message",onWorkerMessage),worker.on("exit",onWorkerExit),registry.register(stream,worker),worker}function drain(stream){assert(!stream[kImpl].sync),stream[kImpl].needDrain&&(stream[kImpl].needDrain=!1,stream.emit("drain"))}function nextFlush(stream){let writeIndex=Atomics.load(stream[kImpl].state,WRITE_INDEX),leftover=stream[kImpl].data.length-writeIndex;if(leftover>0){if(stream[kImpl].buf.length===0){stream[kImpl].flushing=!1,stream[kImpl].ending?end(stream):stream[kImpl].needDrain&&process.nextTick(drain,stream);return}let toWrite=stream[kImpl].buf.slice(0,leftover),toWriteBytes=Buffer.byteLength(toWrite);toWriteBytes<=leftover?(stream[kImpl].buf=stream[kImpl].buf.slice(leftover),write(stream,toWrite,nextFlush.bind(null,stream))):stream.flush(()=>{if(!stream.destroyed){for(Atomics.store(stream[kImpl].state,READ_INDEX,0),Atomics.store(stream[kImpl].state,WRITE_INDEX,0),Atomics.notify(stream[kImpl].state,READ_INDEX);toWriteBytes>stream[kImpl].data.length;)leftover=leftover/2,toWrite=stream[kImpl].buf.slice(0,leftover),toWriteBytes=Buffer.byteLength(toWrite);stream[kImpl].buf=stream[kImpl].buf.slice(leftover),write(stream,toWrite,nextFlush.bind(null,stream))}})}else if(leftover===0){if(writeIndex===0&&stream[kImpl].buf.length===0)return;stream.flush(()=>{Atomics.store(stream[kImpl].state,READ_INDEX,0),Atomics.store(stream[kImpl].state,WRITE_INDEX,0),Atomics.notify(stream[kImpl].state,READ_INDEX),nextFlush(stream)})}else destroy(stream,new Error("overwritten"))}function onWorkerMessage(msg){let stream=this.stream.deref();if(stream===void 0){this.exited=!0,this.terminate();return}switch(msg.code){case"READY":this.stream=new WeakRef2(stream),stream.flush(()=>{stream[kImpl].ready=!0,stream.emit("ready")});break;case"ERROR":destroy(stream,msg.err);break;case"EVENT":Array.isArray(msg.args)?stream.emit(msg.name,...msg.args):stream.emit(msg.name,msg.args);break;case"WARNING":process.emitWarning(msg.err);break;default:destroy(stream,new Error("this should not happen: "+msg.code))}}function onWorkerExit(code){let stream=this.stream.deref();stream!==void 0&&(registry.unregister(stream),stream.worker.exited=!0,stream.worker.off("exit",onWorkerExit),destroy(stream,code!==0?new Error("the worker thread exited"):null))}var ThreadStream=class extends EventEmitter{constructor(opts={}){if(super(),opts.bufferSize<4)throw new Error("bufferSize must at least fit a 4-byte utf-8 char");this[kImpl]={},this[kImpl].stateBuf=new SharedArrayBuffer(128),this[kImpl].state=new Int32Array(this[kImpl].stateBuf),this[kImpl].dataBuf=new SharedArrayBuffer(opts.bufferSize||4*1024*1024),this[kImpl].data=Buffer.from(this[kImpl].dataBuf),this[kImpl].sync=opts.sync||!1,this[kImpl].ending=!1,this[kImpl].ended=!1,this[kImpl].needDrain=!1,this[kImpl].destroyed=!1,this[kImpl].flushing=!1,this[kImpl].ready=!1,this[kImpl].finished=!1,this[kImpl].errored=null,this[kImpl].closed=!1,this[kImpl].buf="",this.worker=createWorker(this,opts),this.on("message",(message,transferList)=>{this.worker.postMessage(message,transferList)})}write(data){if(this[kImpl].destroyed)return error(this,new Error("the worker has exited")),!1;if(this[kImpl].ending)return error(this,new Error("the worker is ending")),!1;if(this[kImpl].flushing&&this[kImpl].buf.length+data.length>=MAX_STRING)try{writeSync(this),this[kImpl].flushing=!0}catch(err){return destroy(this,err),!1}if(this[kImpl].buf+=data,this[kImpl].sync)try{return writeSync(this),!0}catch(err){return destroy(this,err),!1}return this[kImpl].flushing||(this[kImpl].flushing=!0,setImmediate(nextFlush,this)),this[kImpl].needDrain=this[kImpl].data.length-this[kImpl].buf.length-Atomics.load(this[kImpl].state,WRITE_INDEX)<=0,!this[kImpl].needDrain}end(){this[kImpl].destroyed||(this[kImpl].ending=!0,end(this))}flush(cb){if(this[kImpl].destroyed){typeof cb=="function"&&process.nextTick(cb,new Error("the worker has exited"));return}let writeIndex=Atomics.load(this[kImpl].state,WRITE_INDEX);wait(this[kImpl].state,READ_INDEX,writeIndex,1/0,(err,res)=>{if(err){destroy(this,err),process.nextTick(cb,err);return}if(res==="not-equal"){this.flush(cb);return}process.nextTick(cb)})}flushSync(){this[kImpl].destroyed||(writeSync(this),flushSync(this))}unref(){this.worker.unref()}ref(){this.worker.ref()}get ready(){return this[kImpl].ready}get destroyed(){return this[kImpl].destroyed}get closed(){return this[kImpl].closed}get writable(){return!this[kImpl].destroyed&&!this[kImpl].ending}get writableEnded(){return this[kImpl].ending}get writableFinished(){return this[kImpl].finished}get writableNeedDrain(){return this[kImpl].needDrain}get writableObjectMode(){return!1}get writableErrored(){return this[kImpl].errored}};function error(stream,err){setImmediate(()=>{stream.emit("error",err)})}function destroy(stream,err){stream[kImpl].destroyed||(stream[kImpl].destroyed=!0,err&&(stream[kImpl].errored=err,error(stream,err)),stream.worker.exited?setImmediate(()=>{stream[kImpl].closed=!0,stream.emit("close")}):stream.worker.terminate().catch(()=>{}).then(()=>{stream[kImpl].closed=!0,stream.emit("close")}))}function write(stream,data,cb){let current=Atomics.load(stream[kImpl].state,WRITE_INDEX),length=Buffer.byteLength(data);return stream[kImpl].data.write(data,current),Atomics.store(stream[kImpl].state,WRITE_INDEX,current+length),Atomics.notify(stream[kImpl].state,WRITE_INDEX),cb(),!0}function end(stream){if(!(stream[kImpl].ended||!stream[kImpl].ending||stream[kImpl].flushing)){stream[kImpl].ended=!0;try{stream.flushSync();let readIndex=Atomics.load(stream[kImpl].state,READ_INDEX);Atomics.store(stream[kImpl].state,WRITE_INDEX,-1),Atomics.notify(stream[kImpl].state,WRITE_INDEX);let spins=0;for(;readIndex!==-1;){if(Atomics.wait(stream[kImpl].state,READ_INDEX,readIndex,1e3),readIndex=Atomics.load(stream[kImpl].state,READ_INDEX),readIndex===-2){destroy(stream,new Error("end() failed"));return}if(++spins===10){destroy(stream,new Error("end() took too long (10s)"));return}}process.nextTick(()=>{stream[kImpl].finished=!0,stream.emit("finish")})}catch(err){destroy(stream,err)}}}function writeSync(stream){let cb=()=>{stream[kImpl].ending?end(stream):stream[kImpl].needDrain&&process.nextTick(drain,stream)};for(stream[kImpl].flushing=!1;stream[kImpl].buf.length!==0;){let writeIndex=Atomics.load(stream[kImpl].state,WRITE_INDEX),leftover=stream[kImpl].data.length-writeIndex;if(leftover===0){flushSync(stream),Atomics.store(stream[kImpl].state,READ_INDEX,0),Atomics.store(stream[kImpl].state,WRITE_INDEX,0),Atomics.notify(stream[kImpl].state,READ_INDEX);continue}else if(leftover<0)throw new Error("overwritten");let toWrite=stream[kImpl].buf.slice(0,leftover),toWriteBytes=Buffer.byteLength(toWrite);if(toWriteBytes<=leftover)stream[kImpl].buf=stream[kImpl].buf.slice(leftover),write(stream,toWrite,cb);else{for(flushSync(stream),Atomics.store(stream[kImpl].state,READ_INDEX,0),Atomics.store(stream[kImpl].state,WRITE_INDEX,0),Atomics.notify(stream[kImpl].state,READ_INDEX);toWriteBytes>stream[kImpl].buf.length;)leftover=leftover/2,toWrite=stream[kImpl].buf.slice(0,leftover),toWriteBytes=Buffer.byteLength(toWrite);stream[kImpl].buf=stream[kImpl].buf.slice(leftover),write(stream,toWrite,cb)}}}function flushSync(stream){if(stream[kImpl].flushing)throw new Error("unable to flush while flushing");let writeIndex=Atomics.load(stream[kImpl].state,WRITE_INDEX),spins=0;for(;;){let readIndex=Atomics.load(stream[kImpl].state,READ_INDEX);if(readIndex===-2)throw Error("_flushSync failed");if(readIndex!==writeIndex)Atomics.wait(stream[kImpl].state,READ_INDEX,readIndex,1e3);else break;if(++spins===10)throw new Error("_flushSync took too long (10s)")}}module2.exports=ThreadStream}});var require_transport=__commonJS({"../../../../node_modules/pino/lib/transport.js"(exports2,module2){"use strict";var{createRequire}=require("module"),getCallers=require_caller(),{join,isAbsolute,sep}=require("node:path"),sleep=require_atomic_sleep(),onExit=require_on_exit_leak_free(),ThreadStream=require_thread_stream();function setupOnExit(stream){onExit.register(stream,autoEnd),onExit.registerBeforeExit(stream,flush),stream.on("close",function(){onExit.unregister(stream)})}function hasPreloadFlags(){let execArgv=process.execArgv;for(let i=0;i<execArgv.length;i++){let arg=execArgv[i];if(arg==="--import"||arg==="--require"||arg==="-r"||arg.startsWith("--import=")||arg.startsWith("--require=")||arg.startsWith("-r="))return!0}return!1}function buildStream(filename,workerData,workerOpts,sync,name){!workerOpts.execArgv&&hasPreloadFlags()&&require.main===void 0&&(workerOpts={...workerOpts,execArgv:[]}),workerOpts={...workerOpts,name};let stream=new ThreadStream({filename,workerData,workerOpts,sync});stream.on("ready",onReady),stream.on("close",function(){process.removeListener("exit",onExit2)}),process.on("exit",onExit2);function onReady(){process.removeListener("exit",onExit2),stream.unref(),workerOpts.autoEnd!==!1&&setupOnExit(stream)}function onExit2(){stream.closed||(stream.flushSync(),sleep(100),stream.end())}return stream}function autoEnd(stream){stream.ref(),stream.flushSync(),stream.end(),stream.once("close",function(){stream.unref()})}function flush(stream){stream.flushSync()}function transport(fullOptions){let{pipeline:pipeline2,targets,levels,dedupe,worker={},caller=getCallers(),sync=!1}=fullOptions,options={...fullOptions.options},callers=typeof caller=="string"?[caller]:caller,bundlerOverrides=typeof globalThis=="object"&&Object.prototype.hasOwnProperty.call(globalThis,"__bundlerPathsOverrides")&&globalThis.__bundlerPathsOverrides&&typeof globalThis.__bundlerPathsOverrides=="object"?globalThis.__bundlerPathsOverrides:Object.create(null),target=fullOptions.target;if(target&&targets)throw new Error("only one of target or targets can be specified");targets?(target=bundlerOverrides["pino-worker"]||join(__dirname,"worker.js"),options.targets=targets.filter(dest=>dest.target).map(dest=>({...dest,target:fixTarget(dest.target)})),options.pipelines=targets.filter(dest=>dest.pipeline).map(dest=>dest.pipeline.map(t=>({...t,level:dest.level,target:fixTarget(t.target)})))):pipeline2&&(target=bundlerOverrides["pino-worker"]||join(__dirname,"worker.js"),options.pipelines=[pipeline2.map(dest=>({...dest,target:fixTarget(dest.target)}))]),levels&&(options.levels=levels),dedupe&&(options.dedupe=dedupe),options.pinoWillSendConfig=!0;let name=targets||pipeline2?"pino.transport":target;return buildStream(fixTarget(target),options,worker,sync,name);function fixTarget(origin){if(origin=bundlerOverrides[origin]||origin,isAbsolute(origin)||origin.indexOf("file://")===0)return origin;if(origin==="pino/file")return join(__dirname,"..","file.js");let fixTarget2;for(let filePath of callers)try{let context=filePath==="node:repl"?process.cwd()+sep:filePath;fixTarget2=createRequire(context).resolve(origin);break}catch{continue}if(!fixTarget2)throw new Error(`unable to determine transport target for "${origin}"`);return fixTarget2}}module2.exports=transport}});var require_tools=__commonJS({"../../../../node_modules/pino/lib/tools.js"(exports2,module2){"use strict";var diagChan=require("node:diagnostics_channel"),format=require_quick_format_unescaped(),{mapHttpRequest,mapHttpResponse}=require_pino_std_serializers(),SonicBoom=require_sonic_boom(),onExit=require_on_exit_leak_free(),{lsCacheSym,chindingsSym,writeSym,serializersSym,formatOptsSym,endSym,stringifiersSym,stringifySym,stringifySafeSym,wildcardFirstSym,nestedKeySym,formattersSym,messageKeySym,errorKeySym,nestedKeyStrSym,msgPrefixSym}=require_symbols(),{isMainThread}=require("worker_threads"),transport=require_transport(),[nodeMajor]=process.versions.node.split(".").map(v=>Number(v)),asJsonChan=diagChan.tracingChannel("pino_asJson"),asString=nodeMajor>=25?str=>JSON.stringify(str):_asString;function noop(){}function genLog(level,hook){if(!hook)return LOG;return function(...args){hook.call(this,args,LOG,level)};function LOG(o,...n){if(typeof o=="object"){let msg=o;o!==null&&(o.method&&o.headers&&o.socket?o=mapHttpRequest(o):typeof o.setHeader=="function"&&(o=mapHttpResponse(o)));let formatParams;msg===null&&n.length===0?formatParams=[null]:(msg=n.shift(),formatParams=n),typeof this[msgPrefixSym]=="string"&&msg!==void 0&&msg!==null&&(msg=this[msgPrefixSym]+msg),this[writeSym](o,format(msg,formatParams,this[formatOptsSym]),level)}else{let msg=o===void 0?n.shift():o;typeof this[msgPrefixSym]=="string"&&msg!==void 0&&msg!==null&&(msg=this[msgPrefixSym]+msg),this[writeSym](null,format(msg,n,this[formatOptsSym]),level)}}}function _asString(str){let result="",last=0,found=!1,point=255,l=str.length;if(l>100)return JSON.stringify(str);for(var i=0;i<l&&point>=32;i++)point=str.charCodeAt(i),(point===34||point===92)&&(result+=str.slice(last,i)+"\\",last=i,found=!0);return found?result+=str.slice(last):result=str,point<32?JSON.stringify(str):'"'+result+'"'}function asJson(obj,msg,num,time){if(asJsonChan.hasSubscribers===!1)return _asJson.call(this,obj,msg,num,time);let store={instance:this,arguments};return asJsonChan.traceSync(_asJson,store,this,obj,msg,num,time)}function _asJson(obj,msg,num,time){let stringify2=this[stringifySym],stringifySafe=this[stringifySafeSym],stringifiers=this[stringifiersSym],end=this[endSym],chindings=this[chindingsSym],serializers=this[serializersSym],formatters=this[formattersSym],messageKey=this[messageKeySym],errorKey=this[errorKeySym],data=this[lsCacheSym][num]+time;data=data+chindings;let value;formatters.log&&(obj=formatters.log(obj));let wildcardStringifier=stringifiers[wildcardFirstSym],propStr="";for(let key in obj)if(value=obj[key],Object.prototype.hasOwnProperty.call(obj,key)&&value!==void 0){serializers[key]?value=serializers[key](value):key===errorKey&&serializers.err&&(value=serializers.err(value));let stringifier=stringifiers[key]||wildcardStringifier;switch(typeof value){case"undefined":case"function":continue;case"number":Number.isFinite(value)===!1&&(value=null);case"boolean":stringifier&&(value=stringifier(value));break;case"string":value=(stringifier||asString)(value);break;default:value=(stringifier||stringify2)(value,stringifySafe)}if(value===void 0)continue;let strKey=asString(key);propStr+=","+strKey+":"+value}let msgStr="";if(msg!==void 0){value=serializers[messageKey]?serializers[messageKey](msg):msg;let stringifier=stringifiers[messageKey]||wildcardStringifier;switch(typeof value){case"function":break;case"number":Number.isFinite(value)===!1&&(value=null);case"boolean":stringifier&&(value=stringifier(value)),msgStr=',"'+messageKey+'":'+value;break;case"string":value=(stringifier||asString)(value),msgStr=',"'+messageKey+'":'+value;break;default:value=(stringifier||stringify2)(value,stringifySafe),msgStr=',"'+messageKey+'":'+value}}return this[nestedKeySym]&&propStr?data+this[nestedKeyStrSym]+propStr.slice(1)+"}"+msgStr+end:data+propStr+msgStr+end}function asChindings(instance,bindings){let value,data=instance[chindingsSym],stringify2=instance[stringifySym],stringifySafe=instance[stringifySafeSym],stringifiers=instance[stringifiersSym],wildcardStringifier=stringifiers[wildcardFirstSym],serializers=instance[serializersSym],formatter=instance[formattersSym].bindings;bindings=formatter(bindings);for(let key in bindings)if(value=bindings[key],((key.length<5||key!=="level"&&key!=="serializers"&&key!=="formatters"&&key!=="customLevels")&&bindings.hasOwnProperty(key)&&value!==void 0)===!0){if(value=serializers[key]?serializers[key](value):value,value=(stringifiers[key]||wildcardStringifier||stringify2)(value,stringifySafe),value===void 0)continue;data+=',"'+key+'":'+value}return data}function hasBeenTampered(stream){return stream.write!==stream.constructor.prototype.write}function buildSafeSonicBoom(opts){let stream=new SonicBoom(opts);return stream.on("error",filterBrokenPipe),!opts.sync&&isMainThread&&(onExit.register(stream,autoEnd),stream.on("close",function(){onExit.unregister(stream)})),stream;function filterBrokenPipe(err){if(err.code==="EPIPE"){stream.write=noop,stream.end=noop,stream.flushSync=noop,stream.destroy=noop;return}stream.removeListener("error",filterBrokenPipe),stream.emit("error",err)}}function autoEnd(stream,eventName){stream.destroyed||(eventName==="beforeExit"?(stream.flush(),stream.on("drain",function(){stream.end()})):stream.flushSync())}function createArgsNormalizer(defaultOptions){return function(instance,caller,opts={},stream){if(typeof opts=="string")stream=buildSafeSonicBoom({dest:opts}),opts={};else if(typeof stream=="string"){if(opts&&opts.transport)throw Error("only one of option.transport or stream can be specified");stream=buildSafeSonicBoom({dest:stream})}else if(opts instanceof SonicBoom||opts.writable||opts._writableState)stream=opts,opts={};else if(opts.transport){if(opts.transport instanceof SonicBoom||opts.transport.writable||opts.transport._writableState)throw Error("option.transport do not allow stream, please pass to option directly. e.g. pino(transport)");if(opts.transport.targets&&opts.transport.targets.length&&opts.formatters&&typeof opts.formatters.level=="function")throw Error("option.transport.targets do not allow custom level formatters");let customLevels;opts.customLevels&&(customLevels=opts.useOnlyCustomLevels?opts.customLevels:Object.assign({},opts.levels,opts.customLevels)),stream=transport({caller,...opts.transport,levels:customLevels})}if(opts=Object.assign({},defaultOptions,opts),opts.serializers=Object.assign({},defaultOptions.serializers,opts.serializers),opts.formatters=Object.assign({},defaultOptions.formatters,opts.formatters),opts.prettyPrint)throw new Error("prettyPrint option is no longer supported, see the pino-pretty package (https://github.com/pinojs/pino-pretty)");let{enabled,onChild}=opts;return enabled===!1&&(opts.level="silent"),onChild||(opts.onChild=noop),stream||(hasBeenTampered(process.stdout)?stream=process.stdout:stream=buildSafeSonicBoom({fd:process.stdout.fd||1})),{opts,stream}}}function stringify(obj,stringifySafeFn){try{return JSON.stringify(obj)}catch{try{return(stringifySafeFn||this[stringifySafeSym])(obj)}catch{return'"[unable to serialize, circular reference is too complex to analyze]"'}}}function buildFormatters(level,bindings,log){return{level,bindings,log}}function normalizeDestFileDescriptor(destination){let fd=Number(destination);return typeof destination=="string"&&Number.isFinite(fd)?fd:destination===void 0?1:destination}module2.exports={noop,buildSafeSonicBoom,asChindings,asJson,genLog,createArgsNormalizer,stringify,buildFormatters,normalizeDestFileDescriptor}}});var require_constants=__commonJS({"../../../../node_modules/pino/lib/constants.js"(exports2,module2){var DEFAULT_LEVELS={trace:10,debug:20,info:30,warn:40,error:50,fatal:60},SORTING_ORDER={ASC:"ASC",DESC:"DESC"};module2.exports={DEFAULT_LEVELS,SORTING_ORDER}}});var require_levels=__commonJS({"../../../../node_modules/pino/lib/levels.js"(exports2,module2){"use strict";var{lsCacheSym,levelValSym,useOnlyCustomLevelsSym,streamSym,formattersSym,hooksSym,levelCompSym}=require_symbols(),{noop,genLog}=require_tools(),{DEFAULT_LEVELS,SORTING_ORDER}=require_constants(),levelMethods={fatal:hook=>{let logFatal=genLog(DEFAULT_LEVELS.fatal,hook);return function(...args){let stream=this[streamSym];if(logFatal.call(this,...args),typeof stream.flushSync=="function")try{stream.flushSync()}catch{}}},error:hook=>genLog(DEFAULT_LEVELS.error,hook),warn:hook=>genLog(DEFAULT_LEVELS.warn,hook),info:hook=>genLog(DEFAULT_LEVELS.info,hook),debug:hook=>genLog(DEFAULT_LEVELS.debug,hook),trace:hook=>genLog(DEFAULT_LEVELS.trace,hook)},nums=Object.keys(DEFAULT_LEVELS).reduce((o,k)=>(o[DEFAULT_LEVELS[k]]=k,o),{}),initialLsCache=Object.keys(nums).reduce((o,k)=>(o[k]='{"level":'+Number(k),o),{});function genLsCache(instance){let formatter=instance[formattersSym].level,{labels}=instance.levels,cache={};for(let label in labels){let level=formatter(labels[label],Number(label));cache[label]=JSON.stringify(level).slice(0,-1)}return instance[lsCacheSym]=cache,instance}function isStandardLevel(level,useOnlyCustomLevels){if(useOnlyCustomLevels)return!1;switch(level){case"fatal":case"error":case"warn":case"info":case"debug":case"trace":return!0;default:return!1}}function setLevel(level){let{labels,values}=this.levels;if(typeof level=="number"){if(labels[level]===void 0)throw Error("unknown level value"+level);level=labels[level]}if(values[level]===void 0)throw Error("unknown level "+level);let preLevelVal=this[levelValSym],levelVal=this[levelValSym]=values[level],useOnlyCustomLevelsVal=this[useOnlyCustomLevelsSym],levelComparison=this[levelCompSym],hook=this[hooksSym].logMethod;for(let key in values){if(levelComparison(values[key],levelVal)===!1){this[key]=noop;continue}this[key]=isStandardLevel(key,useOnlyCustomLevelsVal)?levelMethods[key](hook):genLog(values[key],hook)}this.emit("level-change",level,levelVal,labels[preLevelVal],preLevelVal,this)}function getLevel(level){let{levels,levelVal}=this;return levels&&levels.labels?levels.labels[levelVal]:""}function isLevelEnabled(logLevel){let{values}=this.levels,logLevelVal=values[logLevel];return logLevelVal!==void 0&&this[levelCompSym](logLevelVal,this[levelValSym])}function compareLevel(direction,current,expected){return direction===SORTING_ORDER.DESC?current<=expected:current>=expected}function genLevelComparison(levelComparison){return typeof levelComparison=="string"?compareLevel.bind(null,levelComparison):levelComparison}function mappings(customLevels=null,useOnlyCustomLevels=!1){let customNums=customLevels?Object.keys(customLevels).reduce((o,k)=>(o[customLevels[k]]=k,o),{}):null,labels=Object.assign(Object.create(Object.prototype,{Infinity:{value:"silent"}}),useOnlyCustomLevels?null:nums,customNums),values=Object.assign(Object.create(Object.prototype,{silent:{value:1/0}}),useOnlyCustomLevels?null:DEFAULT_LEVELS,customLevels);return{labels,values}}function assertDefaultLevelFound(defaultLevel,customLevels,useOnlyCustomLevels){if(typeof defaultLevel=="number"){if(![].concat(Object.keys(customLevels||{}).map(key=>customLevels[key]),useOnlyCustomLevels?[]:Object.keys(nums).map(level=>+level),1/0).includes(defaultLevel))throw Error(`default level:${defaultLevel} must be included in custom levels`);return}let labels=Object.assign(Object.create(Object.prototype,{silent:{value:1/0}}),useOnlyCustomLevels?null:DEFAULT_LEVELS,customLevels);if(!(defaultLevel in labels))throw Error(`default level:${defaultLevel} must be included in custom levels`)}function assertNoLevelCollisions(levels,customLevels){let{labels,values}=levels;for(let k in customLevels){if(k in values)throw Error("levels cannot be overridden");if(customLevels[k]in labels)throw Error("pre-existing level values cannot be used for new levels")}}function assertLevelComparison(levelComparison){if(typeof levelComparison!="function"&&!(typeof levelComparison=="string"&&Object.values(SORTING_ORDER).includes(levelComparison)))throw new Error('Levels comparison should be one of "ASC", "DESC" or "function" type')}module2.exports={initialLsCache,genLsCache,levelMethods,getLevel,setLevel,isLevelEnabled,mappings,assertNoLevelCollisions,assertDefaultLevelFound,genLevelComparison,assertLevelComparison}}});var require_meta=__commonJS({"../../../../node_modules/pino/lib/meta.js"(exports2,module2){"use strict";module2.exports={version:"10.3.0"}}});var require_proto=__commonJS({"../../../../node_modules/pino/lib/proto.js"(exports2,module2){"use strict";var{EventEmitter}=require("node:events"),{lsCacheSym,levelValSym,setLevelSym,getLevelSym,chindingsSym,mixinSym,asJsonSym,writeSym,mixinMergeStrategySym,timeSym,timeSliceIndexSym,streamSym,serializersSym,formattersSym,errorKeySym,messageKeySym,useOnlyCustomLevelsSym,needsMetadataGsym,redactFmtSym,stringifySym,formatOptsSym,stringifiersSym,msgPrefixSym,hooksSym}=require_symbols(),{getLevel,setLevel,isLevelEnabled,mappings,initialLsCache,genLsCache,assertNoLevelCollisions}=require_levels(),{asChindings,asJson,buildFormatters,stringify,noop}=require_tools(),{version}=require_meta(),redaction=require_redaction(),constructor=class{},prototype={constructor,child,bindings,setBindings,flush,isLevelEnabled,version,get level(){return this[getLevelSym]()},set level(lvl){this[setLevelSym](lvl)},get levelVal(){return this[levelValSym]},set levelVal(n){throw Error("levelVal is read-only")},get msgPrefix(){return this[msgPrefixSym]},get[Symbol.toStringTag](){return"Pino"},[lsCacheSym]:initialLsCache,[writeSym]:write,[asJsonSym]:asJson,[getLevelSym]:getLevel,[setLevelSym]:setLevel};Object.setPrototypeOf(prototype,EventEmitter.prototype);module2.exports=function(){return Object.create(prototype)};var resetChildingsFormatter=bindings2=>bindings2;function child(bindings2,options){if(!bindings2)throw Error("missing bindings for child Pino");let serializers=this[serializersSym],formatters=this[formattersSym],instance=Object.create(this);if(options==null)return instance[formattersSym].bindings!==resetChildingsFormatter&&(instance[formattersSym]=buildFormatters(formatters.level,resetChildingsFormatter,formatters.log)),instance[chindingsSym]=asChindings(instance,bindings2),this.onChild!==noop&&this.onChild(instance),instance;if(options.hasOwnProperty("serializers")===!0){instance[serializersSym]=Object.create(null);for(let k in serializers)instance[serializersSym][k]=serializers[k];let parentSymbols=Object.getOwnPropertySymbols(serializers);for(var i=0;i<parentSymbols.length;i++){let ks=parentSymbols[i];instance[serializersSym][ks]=serializers[ks]}for(let bk in options.serializers)instance[serializersSym][bk]=options.serializers[bk];let bindingsSymbols=Object.getOwnPropertySymbols(options.serializers);for(var bi=0;bi<bindingsSymbols.length;bi++){let bks=bindingsSymbols[bi];instance[serializersSym][bks]=options.serializers[bks]}}else instance[serializersSym]=serializers;if(options.hasOwnProperty("formatters")){let{level,bindings:chindings,log}=options.formatters;instance[formattersSym]=buildFormatters(level||formatters.level,chindings||resetChildingsFormatter,log||formatters.log)}else instance[formattersSym]=buildFormatters(formatters.level,resetChildingsFormatter,formatters.log);if(options.hasOwnProperty("customLevels")===!0&&(assertNoLevelCollisions(this.levels,options.customLevels),instance.levels=mappings(options.customLevels,instance[useOnlyCustomLevelsSym]),genLsCache(instance)),typeof options.redact=="object"&&options.redact!==null||Array.isArray(options.redact)){instance.redact=options.redact;let stringifiers=redaction(instance.redact,stringify),formatOpts={stringify:stringifiers[redactFmtSym]};instance[stringifySym]=stringify,instance[stringifiersSym]=stringifiers,instance[formatOptsSym]=formatOpts}if(typeof options.msgPrefix=="string"&&(instance[msgPrefixSym]=(this[msgPrefixSym]||"")+options.msgPrefix),instance[chindingsSym]=asChindings(instance,bindings2),options.level!==void 0&&options.level!==this.level||options.hasOwnProperty("customLevels")){let childLevel=options.level||this.level;instance[setLevelSym](childLevel)}return this.onChild(instance),instance}function bindings(){let chindingsJson=`{${this[chindingsSym].substr(1)}}`,bindingsFromJson=JSON.parse(chindingsJson);return delete bindingsFromJson.pid,delete bindingsFromJson.hostname,bindingsFromJson}function setBindings(newBindings){let chindings=asChindings(this,newBindings);this[chindingsSym]=chindings}function defaultMixinMergeStrategy(mergeObject,mixinObject){return Object.assign(mixinObject,mergeObject)}function write(_obj,msg,num){let t=this[timeSym](),mixin=this[mixinSym],errorKey=this[errorKeySym],messageKey=this[messageKeySym],mixinMergeStrategy=this[mixinMergeStrategySym]||defaultMixinMergeStrategy,obj,streamWriteHook=this[hooksSym].streamWrite;_obj==null?obj={}:_obj instanceof Error?(obj={[errorKey]:_obj},msg===void 0&&(msg=_obj.message)):(obj=_obj,msg===void 0&&_obj[messageKey]===void 0&&_obj[errorKey]&&(msg=_obj[errorKey].message)),mixin&&(obj=mixinMergeStrategy(obj,mixin(obj,num,this)));let s=this[asJsonSym](obj,msg,num,t),stream=this[streamSym];stream[needsMetadataGsym]===!0&&(stream.lastLevel=num,stream.lastObj=obj,stream.lastMsg=msg,stream.lastTime=t.slice(this[timeSliceIndexSym]),stream.lastLogger=this),stream.write(streamWriteHook?streamWriteHook(s):s)}function flush(cb){if(cb!=null&&typeof cb!="function")throw Error("callback must be a function");let stream=this[streamSym];typeof stream.flush=="function"?stream.flush(cb||noop):cb&&cb()}}});var require_safe_stable_stringify=__commonJS({"../../../../node_modules/safe-stable-stringify/index.js"(exports2,module2){"use strict";var{hasOwnProperty}=Object.prototype,stringify=configure();stringify.configure=configure;stringify.stringify=stringify;stringify.default=stringify;exports2.stringify=stringify;exports2.configure=configure;module2.exports=stringify;var strEscapeSequencesRegExp=/[\u0000-\u001f\u0022\u005c\ud800-\udfff]/;function strEscape(str){return str.length<5e3&&!strEscapeSequencesRegExp.test(str)?`"${str}"`:JSON.stringify(str)}function sort(array,comparator){if(array.length>200||comparator)return array.sort(comparator);for(let i=1;i<array.length;i++){let currentValue=array[i],position=i;for(;position!==0&&array[position-1]>currentValue;)array[position]=array[position-1],position--;array[position]=currentValue}return array}var typedArrayPrototypeGetSymbolToStringTag=Object.getOwnPropertyDescriptor(Object.getPrototypeOf(Object.getPrototypeOf(new Int8Array)),Symbol.toStringTag).get;function isTypedArrayWithEntries(value){return typedArrayPrototypeGetSymbolToStringTag.call(value)!==void 0&&value.length!==0}function stringifyTypedArray(array,separator,maximumBreadth){array.length<maximumBreadth&&(maximumBreadth=array.length);let whitespace=separator===","?"":" ",res=`"0":${whitespace}${array[0]}`;for(let i=1;i<maximumBreadth;i++)res+=`${separator}"${i}":${whitespace}${array[i]}`;return res}function getCircularValueOption(options){if(hasOwnProperty.call(options,"circularValue")){let circularValue=options.circularValue;if(typeof circularValue=="string")return`"${circularValue}"`;if(circularValue==null)return circularValue;if(circularValue===Error||circularValue===TypeError)return{toString(){throw new TypeError("Converting circular structure to JSON")}};throw new TypeError('The "circularValue" argument must be of type string or the value null or undefined')}return'"[Circular]"'}function getDeterministicOption(options){let value;if(hasOwnProperty.call(options,"deterministic")&&(value=options.deterministic,typeof value!="boolean"&&typeof value!="function"))throw new TypeError('The "deterministic" argument must be of type boolean or comparator function');return value===void 0?!0:value}function getBooleanOption(options,key){let value;if(hasOwnProperty.call(options,key)&&(value=options[key],typeof value!="boolean"))throw new TypeError(`The "${key}" argument must be of type boolean`);return value===void 0?!0:value}function getPositiveIntegerOption(options,key){let value;if(hasOwnProperty.call(options,key)){if(value=options[key],typeof value!="number")throw new TypeError(`The "${key}" argument must be of type number`);if(!Number.isInteger(value))throw new TypeError(`The "${key}" argument must be an integer`);if(value<1)throw new RangeError(`The "${key}" argument must be >= 1`)}return value===void 0?1/0:value}function getItemCount(number){return number===1?"1 item":`${number} items`}function getUniqueReplacerSet(replacerArray){let replacerSet=new Set;for(let value of replacerArray)(typeof value=="string"||typeof value=="number")&&replacerSet.add(String(value));return replacerSet}function getStrictOption(options){if(hasOwnProperty.call(options,"strict")){let value=options.strict;if(typeof value!="boolean")throw new TypeError('The "strict" argument must be of type boolean');if(value)return value2=>{let message=`Object can not safely be stringified. Received type ${typeof value2}`;throw typeof value2!="function"&&(message+=` (${value2.toString()})`),new Error(message)}}}function configure(options){options={...options};let fail=getStrictOption(options);fail&&(options.bigint===void 0&&(options.bigint=!1),"circularValue"in options||(options.circularValue=Error));let circularValue=getCircularValueOption(options),bigint=getBooleanOption(options,"bigint"),deterministic=getDeterministicOption(options),comparator=typeof deterministic=="function"?deterministic:void 0,maximumDepth=getPositiveIntegerOption(options,"maximumDepth"),maximumBreadth=getPositiveIntegerOption(options,"maximumBreadth");function stringifyFnReplacer(key,parent,stack,replacer,spacer,indentation){let value=parent[key];switch(typeof value=="object"&&value!==null&&typeof value.toJSON=="function"&&(value=value.toJSON(key)),value=replacer.call(parent,key,value),typeof value){case"string":return strEscape(value);case"object":{if(value===null)return"null";if(stack.indexOf(value)!==-1)return circularValue;let res="",join=",",originalIndentation=indentation;if(Array.isArray(value)){if(value.length===0)return"[]";if(maximumDepth<stack.length+1)return'"[Array]"';stack.push(value),spacer!==""&&(indentation+=spacer,res+=`
${indentation}`,join=`,
${indentation}`);let maximumValuesToStringify=Math.min(value.length,maximumBreadth),i=0;for(;i<maximumValuesToStringify-1;i++){let tmp2=stringifyFnReplacer(String(i),value,stack,replacer,spacer,indentation);res+=tmp2!==void 0?tmp2:"null",res+=join}let tmp=stringifyFnReplacer(String(i),value,stack,replacer,spacer,indentation);if(res+=tmp!==void 0?tmp:"null",value.length-1>maximumBreadth){let removedKeys=value.length-maximumBreadth-1;res+=`${join}"... ${getItemCount(removedKeys)} not stringified"`}return spacer!==""&&(res+=`
${originalIndentation}`),stack.pop(),`[${res}]`}let keys=Object.keys(value),keyLength=keys.length;if(keyLength===0)return"{}";if(maximumDepth<stack.length+1)return'"[Object]"';let whitespace="",separator="";spacer!==""&&(indentation+=spacer,join=`,
${indentation}`,whitespace=" ");let maximumPropertiesToStringify=Math.min(keyLength,maximumBreadth);deterministic&&!isTypedArrayWithEntries(value)&&(keys=sort(keys,comparator)),stack.push(value);for(let i=0;i<maximumPropertiesToStringify;i++){let key2=keys[i],tmp=stringifyFnReplacer(key2,value,stack,replacer,spacer,indentation);tmp!==void 0&&(res+=`${separator}${strEscape(key2)}:${whitespace}${tmp}`,separator=join)}if(keyLength>maximumBreadth){let removedKeys=keyLength-maximumBreadth;res+=`${separator}"...":${whitespace}"${getItemCount(removedKeys)} not stringified"`,separator=join}return spacer!==""&&separator.length>1&&(res=`
${indentation}${res}
${originalIndentation}`),stack.pop(),`{${res}}`}case"number":return isFinite(value)?String(value):fail?fail(value):"null";case"boolean":return value===!0?"true":"false";case"undefined":return;case"bigint":if(bigint)return String(value);default:return fail?fail(value):void 0}}function stringifyArrayReplacer(key,value,stack,replacer,spacer,indentation){switch(typeof value=="object"&&value!==null&&typeof value.toJSON=="function"&&(value=value.toJSON(key)),typeof value){case"string":return strEscape(value);case"object":{if(value===null)return"null";if(stack.indexOf(value)!==-1)return circularValue;let originalIndentation=indentation,res="",join=",";if(Array.isArray(value)){if(value.length===0)return"[]";if(maximumDepth<stack.length+1)return'"[Array]"';stack.push(value),spacer!==""&&(indentation+=spacer,res+=`
${indentation}`,join=`,
${indentation}`);let maximumValuesToStringify=Math.min(value.length,maximumBreadth),i=0;for(;i<maximumValuesToStringify-1;i++){let tmp2=stringifyArrayReplacer(String(i),value[i],stack,replacer,spacer,indentation);res+=tmp2!==void 0?tmp2:"null",res+=join}let tmp=stringifyArrayReplacer(String(i),value[i],stack,replacer,spacer,indentation);if(res+=tmp!==void 0?tmp:"null",value.length-1>maximumBreadth){let removedKeys=value.length-maximumBreadth-1;res+=`${join}"... ${getItemCount(removedKeys)} not stringified"`}return spacer!==""&&(res+=`
${originalIndentation}`),stack.pop(),`[${res}]`}stack.push(value);let whitespace="";spacer!==""&&(indentation+=spacer,join=`,
${indentation}`,whitespace=" ");let separator="";for(let key2 of replacer){let tmp=stringifyArrayReplacer(key2,value[key2],stack,replacer,spacer,indentation);tmp!==void 0&&(res+=`${separator}${strEscape(key2)}:${whitespace}${tmp}`,separator=join)}return spacer!==""&&separator.length>1&&(res=`
${indentation}${res}
${originalIndentation}`),stack.pop(),`{${res}}`}case"number":return isFinite(value)?String(value):fail?fail(value):"null";case"boolean":return value===!0?"true":"false";case"undefined":return;case"bigint":if(bigint)return String(value);default:return fail?fail(value):void 0}}function stringifyIndent(key,value,stack,spacer,indentation){switch(typeof value){case"string":return strEscape(value);case"object":{if(value===null)return"null";if(typeof value.toJSON=="function"){if(value=value.toJSON(key),typeof value!="object")return stringifyIndent(key,value,stack,spacer,indentation);if(value===null)return"null"}if(stack.indexOf(value)!==-1)return circularValue;let originalIndentation=indentation;if(Array.isArray(value)){if(value.length===0)return"[]";if(maximumDepth<stack.length+1)return'"[Array]"';stack.push(value),indentation+=spacer;let res2=`
${indentation}`,join2=`,
${indentation}`,maximumValuesToStringify=Math.min(value.length,maximumBreadth),i=0;for(;i<maximumValuesToStringify-1;i++){let tmp2=stringifyIndent(String(i),value[i],stack,spacer,indentation);res2+=tmp2!==void 0?tmp2:"null",res2+=join2}let tmp=stringifyIndent(String(i),value[i],stack,spacer,indentation);if(res2+=tmp!==void 0?tmp:"null",value.length-1>maximumBreadth){let removedKeys=value.length-maximumBreadth-1;res2+=`${join2}"... ${getItemCount(removedKeys)} not stringified"`}return res2+=`
${originalIndentation}`,stack.pop(),`[${res2}]`}let keys=Object.keys(value),keyLength=keys.length;if(keyLength===0)return"{}";if(maximumDepth<stack.length+1)return'"[Object]"';indentation+=spacer;let join=`,
${indentation}`,res="",separator="",maximumPropertiesToStringify=Math.min(keyLength,maximumBreadth);isTypedArrayWithEntries(value)&&(res+=stringifyTypedArray(value,join,maximumBreadth),keys=keys.slice(value.length),maximumPropertiesToStringify-=value.length,separator=join),deterministic&&(keys=sort(keys,comparator)),stack.push(value);for(let i=0;i<maximumPropertiesToStringify;i++){let key2=keys[i],tmp=stringifyIndent(key2,value[key2],stack,spacer,indentation);tmp!==void 0&&(res+=`${separator}${strEscape(key2)}: ${tmp}`,separator=join)}if(keyLength>maximumBreadth){let removedKeys=keyLength-maximumBreadth;res+=`${separator}"...": "${getItemCount(removedKeys)} not stringified"`,separator=join}return separator!==""&&(res=`
${indentation}${res}
${originalIndentation}`),stack.pop(),`{${res}}`}case"number":return isFinite(value)?String(value):fail?fail(value):"null";case"boolean":return value===!0?"true":"false";case"undefined":return;case"bigint":if(bigint)return String(value);default:return fail?fail(value):void 0}}function stringifySimple(key,value,stack){switch(typeof value){case"string":return strEscape(value);case"object":{if(value===null)return"null";if(typeof value.toJSON=="function"){if(value=value.toJSON(key),typeof value!="object")return stringifySimple(key,value,stack);if(value===null)return"null"}if(stack.indexOf(value)!==-1)return circularValue;let res="",hasLength=value.length!==void 0;if(hasLength&&Array.isArray(value)){if(value.length===0)return"[]";if(maximumDepth<stack.length+1)return'"[Array]"';stack.push(value);let maximumValuesToStringify=Math.min(value.length,maximumBreadth),i=0;for(;i<maximumValuesToStringify-1;i++){let tmp2=stringifySimple(String(i),value[i],stack);res+=tmp2!==void 0?tmp2:"null",res+=","}let tmp=stringifySimple(String(i),value[i],stack);if(res+=tmp!==void 0?tmp:"null",value.length-1>maximumBreadth){let removedKeys=value.length-maximumBreadth-1;res+=`,"... ${getItemCount(removedKeys)} not stringified"`}return stack.pop(),`[${res}]`}let keys=Object.keys(value),keyLength=keys.length;if(keyLength===0)return"{}";if(maximumDepth<stack.length+1)return'"[Object]"';let separator="",maximumPropertiesToStringify=Math.min(keyLength,maximumBreadth);hasLength&&isTypedArrayWithEntries(value)&&(res+=stringifyTypedArray(value,",",maximumBreadth),keys=keys.slice(value.length),maximumPropertiesToStringify-=value.length,separator=","),deterministic&&(keys=sort(keys,comparator)),stack.push(value);for(let i=0;i<maximumPropertiesToStringify;i++){let key2=keys[i],tmp=stringifySimple(key2,value[key2],stack);tmp!==void 0&&(res+=`${separator}${strEscape(key2)}:${tmp}`,separator=",")}if(keyLength>maximumBreadth){let removedKeys=keyLength-maximumBreadth;res+=`${separator}"...":"${getItemCount(removedKeys)} not stringified"`}return stack.pop(),`{${res}}`}case"number":return isFinite(value)?String(value):fail?fail(value):"null";case"boolean":return value===!0?"true":"false";case"undefined":return;case"bigint":if(bigint)return String(value);default:return fail?fail(value):void 0}}function stringify2(value,replacer,space){if(arguments.length>1){let spacer="";if(typeof space=="number"?spacer=" ".repeat(Math.min(space,10)):typeof space=="string"&&(spacer=space.slice(0,10)),replacer!=null){if(typeof replacer=="function")return stringifyFnReplacer("",{"":value},[],replacer,spacer,"");if(Array.isArray(replacer))return stringifyArrayReplacer("",value,[],getUniqueReplacerSet(replacer),spacer,"")}if(spacer.length!==0)return stringifyIndent("",value,[],spacer,"")}return stringifySimple("",value,[])}return stringify2}}});var require_multistream=__commonJS({"../../../../node_modules/pino/lib/multistream.js"(exports2,module2){"use strict";var metadata=Symbol.for("pino.metadata"),{DEFAULT_LEVELS}=require_constants(),DEFAULT_INFO_LEVEL=DEFAULT_LEVELS.info;function multistream(streamsArray,opts){streamsArray=streamsArray||[],opts=opts||{dedupe:!1};let streamLevels=Object.create(DEFAULT_LEVELS);streamLevels.silent=1/0,opts.levels&&typeof opts.levels=="object"&&Object.keys(opts.levels).forEach(i=>{streamLevels[i]=opts.levels[i]});let res={write,add,remove,emit,flushSync,end,minLevel:0,lastId:0,streams:[],clone,[metadata]:!0,streamLevels};return Array.isArray(streamsArray)?streamsArray.forEach(add,res):add.call(res,streamsArray),streamsArray=null,res;function write(data){let dest,level=this.lastLevel,{streams}=this,recordedLevel=0,stream;for(let i=initLoopVar(streams.length,opts.dedupe);checkLoopVar(i,streams.length,opts.dedupe);i=adjustLoopVar(i,opts.dedupe))if(dest=streams[i],dest.level<=level){if(recordedLevel!==0&&recordedLevel!==dest.level)break;if(stream=dest.stream,stream[metadata]){let{lastTime,lastMsg,lastObj,lastLogger}=this;stream.lastLevel=level,stream.lastTime=lastTime,stream.lastMsg=lastMsg,stream.lastObj=lastObj,stream.lastLogger=lastLogger}stream.write(data),opts.dedupe&&(recordedLevel=dest.level)}else if(!opts.dedupe)break}function emit(...args){for(let{stream}of this.streams)typeof stream.emit=="function"&&stream.emit(...args)}function flushSync(){for(let{stream}of this.streams)typeof stream.flushSync=="function"&&stream.flushSync()}function add(dest){if(!dest)return res;let isStream=typeof dest.write=="function"||dest.stream,stream_=dest.write?dest:dest.stream;if(!isStream)throw Error("stream object needs to implement either StreamEntry or DestinationStream interface");let{streams,streamLevels:streamLevels2}=this,level;typeof dest.levelVal=="number"?level=dest.levelVal:typeof dest.level=="string"?level=streamLevels2[dest.level]:typeof dest.level=="number"?level=dest.level:level=DEFAULT_INFO_LEVEL;let dest_={stream:stream_,level,levelVal:void 0,id:++res.lastId};return streams.unshift(dest_),streams.sort(compareByLevel),this.minLevel=streams[0].level,res}function remove(id){let{streams}=this,index=streams.findIndex(s=>s.id===id);return index>=0&&(streams.splice(index,1),streams.sort(compareByLevel),this.minLevel=streams.length>0?streams[0].level:-1),res}function end(){for(let{stream}of this.streams)typeof stream.flushSync=="function"&&stream.flushSync(),stream.end()}function clone(level){let streams=new Array(this.streams.length);for(let i=0;i<streams.length;i++)streams[i]={level,stream:this.streams[i].stream};return{write,add,remove,minLevel:level,streams,clone,emit,flushSync,[metadata]:!0}}}function compareByLevel(a,b){return a.level-b.level}function initLoopVar(length,dedupe){return dedupe?length-1:0}function adjustLoopVar(i,dedupe){return dedupe?i-1:i+1}function checkLoopVar(i,length,dedupe){return dedupe?i>=0:i<length}module2.exports=multistream}});var require_pino=__commonJS({"../../../../node_modules/pino/pino.js"(exports2,module2){function pinoBundlerAbsolutePath(p){try{return require("path").resolve("/Users/kushchov/work/braiins/frontend/packages/froxy/build/server",p.replace(/^\.\//,""))}catch{return new Function("p","return new URL(p, import.meta.url).pathname")(p)}}globalThis.__bundlerPathsOverrides={...globalThis.__bundlerPathsOverrides||{},"thread-stream-worker":pinoBundlerAbsolutePath("./thread-stream-worker.cjs"),"pino-worker":pinoBundlerAbsolutePath("./pino-worker.cjs"),"pino/file":pinoBundlerAbsolutePath("./pino-file.cjs"),"pino-pretty":pinoBundlerAbsolutePath("./pino-pretty.cjs")};var os=require("node:os"),stdSerializers=require_pino_std_serializers(),caller=require_caller(),redaction=require_redaction(),time=require_time(),proto=require_proto(),symbols=require_symbols(),{configure}=require_safe_stable_stringify(),{assertDefaultLevelFound,mappings,genLsCache,genLevelComparison,assertLevelComparison}=require_levels(),{DEFAULT_LEVELS,SORTING_ORDER}=require_constants(),{createArgsNormalizer,asChindings,buildSafeSonicBoom,buildFormatters,stringify,normalizeDestFileDescriptor,noop}=require_tools(),{version}=require_meta(),{chindingsSym,redactFmtSym,serializersSym,timeSym,timeSliceIndexSym,streamSym,stringifySym,stringifySafeSym,stringifiersSym,setLevelSym,endSym,formatOptsSym,messageKeySym,errorKeySym,nestedKeySym,mixinSym,levelCompSym,useOnlyCustomLevelsSym,formattersSym,hooksSym,nestedKeyStrSym,mixinMergeStrategySym,msgPrefixSym}=symbols,{epochTime,nullTime}=time,{pid}=process,hostname=os.hostname(),defaultErrorSerializer=stdSerializers.err,defaultOptions={level:"info",levelComparison:SORTING_ORDER.ASC,levels:DEFAULT_LEVELS,messageKey:"msg",errorKey:"err",nestedKey:null,enabled:!0,base:{pid,hostname},serializers:Object.assign(Object.create(null),{err:defaultErrorSerializer}),formatters:Object.assign(Object.create(null),{bindings(bindings){return bindings},level(label,number){return{level:number}}}),hooks:{logMethod:void 0,streamWrite:void 0},timestamp:epochTime,name:void 0,redact:null,customLevels:null,useOnlyCustomLevels:!1,depthLimit:5,edgeLimit:100},normalize=createArgsNormalizer(defaultOptions),serializers=Object.assign(Object.create(null),stdSerializers);function pino2(...args){let instance={},{opts,stream}=normalize(instance,caller(),...args);opts.level&&typeof opts.level=="string"&&DEFAULT_LEVELS[opts.level.toLowerCase()]!==void 0&&(opts.level=opts.level.toLowerCase());let{redact,crlf,serializers:serializers2,timestamp,messageKey,errorKey,nestedKey,base,name,level,customLevels,levelComparison,mixin,mixinMergeStrategy,useOnlyCustomLevels,formatters,hooks,depthLimit,edgeLimit,onChild,msgPrefix}=opts,stringifySafe=configure({maximumDepth:depthLimit,maximumBreadth:edgeLimit}),allFormatters=buildFormatters(formatters.level,formatters.bindings,formatters.log),stringifyFn=stringify.bind({[stringifySafeSym]:stringifySafe}),stringifiers=redact?redaction(redact,stringifyFn):{},formatOpts=redact?{stringify:stringifiers[redactFmtSym]}:{stringify:stringifyFn},end="}"+(crlf?`\r
`:`
`),coreChindings=asChindings.bind(null,{[chindingsSym]:"",[serializersSym]:serializers2,[stringifiersSym]:stringifiers,[stringifySym]:stringify,[stringifySafeSym]:stringifySafe,[formattersSym]:allFormatters}),chindings="";base!==null&&(name===void 0?chindings=coreChindings(base):chindings=coreChindings(Object.assign({},base,{name})));let time2=timestamp instanceof Function?timestamp:timestamp?epochTime:nullTime,timeSliceIndex=time2().indexOf(":")+1;if(useOnlyCustomLevels&&!customLevels)throw Error("customLevels is required if useOnlyCustomLevels is set true");if(mixin&&typeof mixin!="function")throw Error(`Unknown mixin type "${typeof mixin}" - expected "function"`);if(msgPrefix&&typeof msgPrefix!="string")throw Error(`Unknown msgPrefix type "${typeof msgPrefix}" - expected "string"`);assertDefaultLevelFound(level,customLevels,useOnlyCustomLevels);let levels=mappings(customLevels,useOnlyCustomLevels);typeof stream.emit=="function"&&stream.emit("message",{code:"PINO_CONFIG",config:{levels,messageKey,errorKey}}),assertLevelComparison(levelComparison);let levelCompFunc=genLevelComparison(levelComparison);return Object.assign(instance,{levels,[levelCompSym]:levelCompFunc,[useOnlyCustomLevelsSym]:useOnlyCustomLevels,[streamSym]:stream,[timeSym]:time2,[timeSliceIndexSym]:timeSliceIndex,[stringifySym]:stringify,[stringifySafeSym]:stringifySafe,[stringifiersSym]:stringifiers,[endSym]:end,[formatOptsSym]:formatOpts,[messageKeySym]:messageKey,[errorKeySym]:errorKey,[nestedKeySym]:nestedKey,[nestedKeyStrSym]:nestedKey?`,${JSON.stringify(nestedKey)}:{`:"",[serializersSym]:serializers2,[mixinSym]:mixin,[mixinMergeStrategySym]:mixinMergeStrategy,[chindingsSym]:chindings,[formattersSym]:allFormatters,[hooksSym]:hooks,silent:noop,onChild,[msgPrefixSym]:msgPrefix}),Object.setPrototypeOf(instance,proto()),genLsCache(instance),instance[setLevelSym](level),instance}module2.exports=pino2;module2.exports.destination=(dest=process.stdout.fd)=>typeof dest=="object"?(dest.dest=normalizeDestFileDescriptor(dest.dest||process.stdout.fd),buildSafeSonicBoom(dest)):buildSafeSonicBoom({dest:normalizeDestFileDescriptor(dest),minLength:0});module2.exports.transport=require_transport();module2.exports.multistream=require_multistream();module2.exports.levels=mappings();module2.exports.stdSerializers=serializers;module2.exports.stdTimeFunctions=Object.assign({},time);module2.exports.symbols=symbols;module2.exports.version=version;module2.exports.default=pino2;module2.exports.pino=pino2}});var require_split2=__commonJS({"../../../../node_modules/split2/index.js"(exports2,module2){"use strict";var{Transform}=require("stream"),{StringDecoder}=require("string_decoder"),kLast=Symbol("last"),kDecoder=Symbol("decoder");function transform(chunk,enc,cb){let list;if(this.overflow){if(list=this[kDecoder].write(chunk).split(this.matcher),list.length===1)return cb();list.shift(),this.overflow=!1}else this[kLast]+=this[kDecoder].write(chunk),list=this[kLast].split(this.matcher);this[kLast]=list.pop();for(let i=0;i<list.length;i++)try{push(this,this.mapper(list[i]))}catch(error){return cb(error)}if(this.overflow=this[kLast].length>this.maxLength,this.overflow&&!this.skipOverflow){cb(new Error("maximum buffer reached"));return}cb()}function flush(cb){if(this[kLast]+=this[kDecoder].end(),this[kLast])try{push(this,this.mapper(this[kLast]))}catch(error){return cb(error)}cb()}function push(self,val){val!==void 0&&self.push(val)}function noop(incoming){return incoming}function split(matcher,mapper,options){switch(matcher=matcher||/\r?\n/,mapper=mapper||noop,options=options||{},arguments.length){case 1:typeof matcher=="function"?(mapper=matcher,matcher=/\r?\n/):typeof matcher=="object"&&!(matcher instanceof RegExp)&&!matcher[Symbol.split]&&(options=matcher,matcher=/\r?\n/);break;case 2:typeof matcher=="function"?(options=mapper,mapper=matcher,matcher=/\r?\n/):typeof mapper=="object"&&(options=mapper,mapper=noop)}options=Object.assign({},options),options.autoDestroy=!0,options.transform=transform,options.flush=flush,options.readableObjectMode=!0;let stream=new Transform(options);return stream[kLast]="",stream[kDecoder]=new StringDecoder("utf8"),stream.matcher=matcher,stream.mapper=mapper,stream.maxLength=options.maxLength,stream.skipOverflow=options.skipOverflow||!1,stream.overflow=!1,stream._destroy=function(err,cb){this._writableState.errorEmitted=!1,cb(err)},stream}module2.exports=split}});var require_pino_abstract_transport=__commonJS({"../../../../node_modules/pino/node_modules/pino-abstract-transport/index.js"(exports2,module2){"use strict";var metadata=Symbol.for("pino.metadata"),split=require_split2(),{Duplex}=require("stream"),{parentPort,workerData}=require("worker_threads");function createDeferred(){let resolve,reject,promise=new Promise((_resolve,_reject)=>{resolve=_resolve,reject=_reject});return promise.resolve=resolve,promise.reject=reject,promise}module2.exports=function(fn,opts={}){let waitForConfig=opts.expectPinoConfig===!0&&workerData?.workerData?.pinoWillSendConfig===!0,parseLines=opts.parse==="lines",parseLine=typeof opts.parseLine=="function"?opts.parseLine:JSON.parse,close=opts.close||defaultClose,stream=split(function(line){let value;try{value=parseLine(line)}catch(error){this.emit("unknown",line,error);return}if(value===null){this.emit("unknown",line,"Null value ignored");return}return typeof value!="object"&&(value={data:value,time:Date.now()}),stream[metadata]&&(stream.lastTime=value.time,stream.lastLevel=value.level,stream.lastObj=value),parseLines?line:value},{autoDestroy:!0});if(stream._destroy=function(err,cb){let promise=close(err,cb);promise&&typeof promise.then=="function"&&promise.then(cb,cb)},opts.expectPinoConfig===!0&&workerData?.workerData?.pinoWillSendConfig!==!0&&setImmediate(()=>{stream.emit("error",new Error("This transport is not compatible with the current version of pino. Please upgrade pino to the latest version."))}),opts.metadata!==!1&&(stream[metadata]=!0,stream.lastTime=0,stream.lastLevel=0,stream.lastObj=null),waitForConfig){let pinoConfig={},configReceived=createDeferred();return parentPort.on("message",function handleMessage(message){message.code==="PINO_CONFIG"&&(pinoConfig=message.config,configReceived.resolve(),parentPort.off("message",handleMessage))}),Object.defineProperties(stream,{levels:{get(){return pinoConfig.levels}},messageKey:{get(){return pinoConfig.messageKey}},errorKey:{get(){return pinoConfig.errorKey}}}),configReceived.then(finish)}return finish();function finish(){let res=fn(stream);if(res&&typeof res.catch=="function")res.catch(err=>{stream.destroy(err)}),res=null;else if(opts.enablePipelining&&res)return Duplex.from({writable:stream,readable:res});return stream}};function defaultClose(err,cb){process.nextTick(cb,err)}}});var require_src=__commonJS({"../../../../node_modules/real-require/src/index.js"(exports2,module2){var realImport=new Function("modulePath","return import(modulePath)");function realRequire(modulePath){return typeof __non_webpack__require__=="function"?__non_webpack__require__(modulePath):require(modulePath)}module2.exports={realImport,realRequire}}});var require_transport_stream=__commonJS({"../../../../node_modules/pino/lib/transport-stream.js"(exports2,module2){"use strict";var{realImport,realRequire}=require_src();module2.exports=loadTransportStreamBuilder2;async function loadTransportStreamBuilder2(target){let fn;try{let toLoad=target.startsWith("file://")?target:"file://"+target;toLoad.endsWith(".ts")||toLoad.endsWith(".cts")?(process[Symbol.for("ts-node.register.instance")]?realRequire("ts-node/register"):process.env&&process.env.TS_NODE_DEV&&realRequire("ts-node-dev"),fn=realRequire(decodeURIComponent(target))):fn=await realImport(toLoad)}catch(error){if(error.code==="ENOTDIR"||error.code==="ERR_MODULE_NOT_FOUND")fn=realRequire(target);else if(error.code===void 0||error.code==="ERR_VM_DYNAMIC_IMPORT_CALLBACK_MISSING")try{fn=realRequire(decodeURIComponent(target))}catch{throw error}else throw error}if(typeof fn=="object"&&(fn=fn.default),typeof fn=="object"&&(fn=fn.default),typeof fn!="function")throw Error("exported worker is not a function");return fn}}});var EE=require("node:events"),{pipeline,PassThrough}=require("node:stream"),pino=require_pino(),build=require_pino_abstract_transport(),loadTransportStreamBuilder=require_transport_stream();module.exports=async function({targets,pipelines,levels,dedupe}){let targetStreams=[];if(targets&&targets.length&&(targets=await Promise.all(targets.map(async t=>{let stream=await(await loadTransportStreamBuilder(t.target))(t.options);return{level:t.level,stream}})),targetStreams.push(...targets)),pipelines&&pipelines.length&&(pipelines=await Promise.all(pipelines.map(async p=>{let level,pipeDests=await Promise.all(p.map(async t=>(level=t.level,await(await loadTransportStreamBuilder(t.target))(t.options))));return{level,stream:createPipeline(pipeDests)}})),targetStreams.push(...pipelines)),targetStreams.length===1)return targetStreams[0].stream;return build(process2,{parse:"lines",metadata:!0,close(err,cb){let expected=0;for(let transport of targetStreams)expected++,transport.stream.on("close",closeCb),transport.stream.end();function closeCb(){--expected===0&&cb(err)}}});function process2(stream){let multi=pino.multistream(targetStreams,{levels,dedupe});stream.on("data",function(chunk){let{lastTime,lastMsg,lastObj,lastLevel}=this;multi.lastLevel=lastLevel,multi.lastTime=lastTime,multi.lastMsg=lastMsg,multi.lastObj=lastObj,multi.write(chunk+`
`)})}function createPipeline(streams){let ee=new EE,stream=new PassThrough({autoDestroy:!0,destroy(_,cb){ee.on("error",cb),ee.on("closed",cb)}});return pipeline(stream,...streams,function(err){if(err&&err.code!=="ERR_STREAM_PREMATURE_CLOSE"){ee.emit("error",err);return}ee.emit("closed")}),stream}};
//# sourceMappingURL=pino-worker.cjs.map
